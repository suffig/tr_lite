var Y=Object.defineProperty;var ee=(d,s,a)=>s in d?Y(d,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):d[s]=a;var O=(d,s,a)=>ee(d,typeof s!="symbol"?s+"":s,a);import{r as S,j as e,z as D,u as te,a as se,L as ae,P as z}from"./index-CZAeFb-9.js";import{E as re}from"./ExportImportManager-CBnN8Fnn.js";import{d as ne}from"./dataManager-CtWei30S.js";import{E as ie}from"./utils-Amc2d86L.js";function le({onClose:d,players:s=[]}){const[a,t]=S.useState("4-4-2"),[r,n]=S.useState({}),[i,o]=S.useState([]),f={"4-4-2":{name:"4-4-2 Classic",positions:{GK:[{x:50,y:85,id:"gk1"}],CB:[{x:35,y:70,id:"cb1"},{x:65,y:70,id:"cb2"}],LB:[{x:15,y:65,id:"lb1"}],RB:[{x:85,y:65,id:"rb1"}],CM:[{x:35,y:45,id:"cm1"},{x:65,y:45,id:"cm2"}],LM:[{x:20,y:40,id:"lm1"}],RM:[{x:80,y:40,id:"rm1"}],ST:[{x:40,y:20,id:"st1"},{x:60,y:20,id:"st2"}]}},"4-3-3":{name:"4-3-3 Attack",positions:{GK:[{x:50,y:85,id:"gk1"}],CB:[{x:35,y:70,id:"cb1"},{x:65,y:70,id:"cb2"}],LB:[{x:15,y:65,id:"lb1"}],RB:[{x:85,y:65,id:"rb1"}],CDM:[{x:50,y:55,id:"cdm1"}],CM:[{x:30,y:40,id:"cm1"},{x:70,y:40,id:"cm2"}],LW:[{x:20,y:25,id:"lw1"}],RW:[{x:80,y:25,id:"rw1"}],ST:[{x:50,y:15,id:"st1"}]}},"3-5-2":{name:"3-5-2 Control",positions:{GK:[{x:50,y:85,id:"gk1"}],CB:[{x:25,y:70,id:"cb1"},{x:50,y:70,id:"cb2"},{x:75,y:70,id:"cb3"}],LWB:[{x:15,y:45,id:"lwb1"}],RWB:[{x:85,y:45,id:"rwb1"}],CDM:[{x:50,y:50,id:"cdm1"}],CM:[{x:35,y:40,id:"cm1"},{x:65,y:40,id:"cm2"}],ST:[{x:40,y:20,id:"st1"},{x:60,y:20,id:"st2"}]}}};S.useEffect(()=>{o([...s]),n({})},[s]);const h=g=>{t(g),n({}),o([...s])},x=(g,v)=>{if(!v)return;const p={...r};Object.keys(p).forEach(b=>{var m;((m=p[b])==null?void 0:m.id)===v.id&&delete p[b]}),p[g]=v,n(p),o(b=>b.filter(m=>m.id!==v.id))},k=g=>{const v=r[g];if(!v)return;const p={...r};delete p[g],n(p),o(b=>[...b,v])},F=()=>{const v=Object.values(r).length;if(v===0)return{attack:0,midfield:0,defense:0,overall:0};const p=["ST","LW","RW","LF","RF"],b=["CM","CDM","CAM","LM","RM","LWB","RWB"],m=["CB","LB","RB","GK"],y=f[a];let N=0,A=0,I=0;Object.entries(y.positions).forEach(([L,U])=>{const T=U.length;p.includes(L)?N+=T:b.includes(L)?A+=T:m.includes(L)&&(I+=T)});const $=N+A+I;return{attack:Math.round(N/$*100),midfield:Math.round(A/$*100),defense:Math.round(I/$*100),overall:v}},u=g=>g==="GK"?"#10B981":["CB","LB","RB"].includes(g)?"#3B82F6":["CM","CDM","CAM","LM","RM","LWB","RWB"].includes(g)?"#F59E0B":["ST","LW","RW","LF","RF"].includes(g)?"#EF4444":"#6B7280",E=()=>{const g={formation:a,players:r,analysis:F(),exportDate:new Date().toISOString()},v=JSON.stringify(g,null,2),p=new Blob([v],{type:"application/json"}),b=document.createElement("a");b.href=URL.createObjectURL(p),b.download=`formation-${a}-${new Date().toISOString().split("T")[0]}.json`,b.click(),D.success("Formation exportiert!")},M=F();return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-2",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg w-full max-w-4xl modal-content",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"‚öΩ Formation Visualizer"}),e.jsx("button",{onClick:d,className:"text-text-muted hover:text-text-primary text-2xl transition-colors",children:"√ó"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Formation ausw√§hlen:"}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:Object.entries(f).map(([g,v])=>e.jsx("button",{onClick:()=>h(g),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${a===g?"bg-primary-green text-white":"bg-bg-tertiary text-text-secondary hover:bg-bg-primary"}`,children:v.name},g))})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-4",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"relative bg-green-600 rounded-lg overflow-hidden",style:{aspectRatio:"2/3"},children:[e.jsxs("div",{className:"absolute inset-0",children:[e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-20 h-20 border-2 border-white rounded-full"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-2 h-2 bg-white rounded-full"}),e.jsx("div",{className:"absolute top-4 left-1/2 transform -translate-x-1/2 w-16 h-12 border-2 border-white"}),e.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 w-16 h-12 border-2 border-white"}),e.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 w-8 h-2 bg-white"}),e.jsx("div",{className:"absolute bottom-0 left-1/2 transform -translate-x-1/2 w-8 h-2 bg-white"}),e.jsx("div",{className:"absolute top-1/2 left-0 right-0 h-0.5 bg-white"})]}),Object.entries(f[a].positions).map(([g,v])=>v.map(p=>{const b=r[p.id];return e.jsxs("div",{className:"absolute transform -translate-x-1/2 -translate-y-1/2 cursor-pointer group",style:{left:`${p.x}%`,top:`${p.y}%`},onClick:()=>{b&&k(p.id)},children:[e.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-white flex items-center justify-center text-white text-xs font-bold shadow-lg transition-transform group-hover:scale-110",style:{backgroundColor:u(g)},children:b?b.name.slice(0,2).toUpperCase():g}),e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-1 text-xs text-white bg-black bg-opacity-50 px-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap",children:b?b.name:`${g} Position`})]},p.id)}))]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-text-primary mb-2",children:["Verf√ºgbare Spieler (",i.length,")"]}),e.jsx("div",{className:"bg-bg-tertiary rounded-lg p-3 max-h-48 overflow-y-auto",children:i.length>0?e.jsx("div",{className:"space-y-2",children:i.map(g=>e.jsxs("div",{className:"p-2 bg-bg-secondary rounded cursor-pointer hover:bg-bg-primary transition-colors",onClick:()=>{const v=f[a],p=Object.entries(v.positions).flatMap(([b,m])=>m.map(y=>({...y,type:b}))).find(b=>!r[b.id]);p?x(p.id,g):D.error("Alle Positionen sind besetzt")},children:[e.jsx("div",{className:"text-sm font-medium text-text-primary",children:g.name}),e.jsxs("div",{className:"text-xs text-text-muted",children:[g.position," ‚Ä¢ ",g.team]})]},g.id))}):e.jsx("div",{className:"text-center py-4 text-text-muted text-sm",children:"Alle Spieler sind aufgestellt"})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary mb-2",children:"Formation Analyse"}),e.jsxs("div",{className:"bg-bg-tertiary rounded-lg p-3 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Angriff:"}),e.jsxs("span",{className:"font-medium text-red-600",children:[M.attack,"%"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Mittelfeld:"}),e.jsxs("span",{className:"font-medium text-yellow-600",children:[M.midfield,"%"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Verteidigung:"}),e.jsxs("span",{className:"font-medium text-blue-600",children:[M.defense,"%"]})]}),e.jsxs("div",{className:"flex justify-between text-sm font-medium border-t border-border-light pt-2",children:[e.jsx("span",{children:"Aufgestellt:"}),e.jsxs("span",{children:[M.overall,"/11"]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:E,className:"w-full btn-primary text-sm py-2",disabled:M.overall===0,children:"üìã Formation exportieren"}),e.jsx("button",{onClick:()=>{n({}),o([...s]),D.success("Formation zur√ºckgesetzt")},className:"w-full btn-secondary text-sm py-2",children:"üîÑ Zur√ºcksetzen"})]})]})]})]})})})}class R{static async fetchPlayerData(s,a){try{const t=`${a}`,r=this.cache.get(t);if(r&&Date.now()-r.timestamp<this.CACHE_DURATION)return console.log(`üì¶ Cache hit for SoFIFA ID: ${a}`),r.data;if(!this.checkRateLimit())return console.warn("‚ö†Ô∏è Rate limit exceeded for SoFIFA requests"),null;console.log(`üåê Attempting to fetch data from SoFIFA: ${s}`);const n=[()=>this.fetchWithCorsProxy(s),()=>this.fetchWithAllowOrigins(s),()=>this.fetchWithServerProxy(s),()=>this.parsePlayerIdFromUrl(s)];for(const i of n)try{const o=await i();if(o)return this.cache.set(t,{data:o,timestamp:Date.now()}),o}catch(o){console.warn(`‚ùå Strategy failed: ${o.message}`);continue}return console.warn(`‚ö†Ô∏è All SoFIFA fetch strategies failed for: ${s}`),null}catch(t){return console.error("‚ùå Error fetching SoFIFA data:",t.message),null}}static checkRateLimit(){const s=Date.now();return s>this.rateLimit.resetTime&&(this.rateLimit.requests=0,this.rateLimit.resetTime=s+6e4),this.rateLimit.requests>=this.rateLimit.maxRequests?!1:(this.rateLimit.requests++,!0)}static async fetchWithCorsProxy(s){const a=[`https://cors-anywhere.herokuapp.com/${s}`,`https://api.allorigins.win/get?url=${encodeURIComponent(s)}`,`https://thingproxy.freeboard.io/fetch/${s}`];for(const t of a)try{console.log(`üîÑ Trying CORS proxy: ${t.split("/")[2]}`);const r=new AbortController,n=setTimeout(()=>r.abort(),1e4),i=await fetch(t,{method:"GET",headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"},signal:r.signal});if(clearTimeout(n),i.ok){let o=await i.text();t.includes("allorigins.win")&&(o=JSON.parse(o).contents);const f=this.parsePlayerDataFromHTML(o);if(f)return console.log(`‚úÖ Successfully fetched via proxy: ${t.split("/")[2]}`),f}}catch(r){console.warn(`‚ùå Proxy failed (${t.split("/")[2]}): ${r.message}`);continue}return null}static async fetchWithAllowOrigins(s){try{console.log("üîÑ Trying direct fetch with CORS headers");const a=await fetch(s,{method:"GET",mode:"cors",headers:{Origin:window.location.origin,Referer:window.location.origin,"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"}});if(a.ok){const t=await a.text(),r=this.parsePlayerDataFromHTML(t);if(r)return console.log("‚úÖ Direct fetch successful"),r}}catch(a){console.warn("‚ùå Direct fetch failed (expected due to CORS):",a.message)}return null}static async fetchWithServerProxy(s){try{const a="/api/proxy-sofifa";console.log("üîÑ Trying server proxy");const t=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:s})});if(t.ok){const r=await t.json();if(r.success&&r.html){const n=this.parsePlayerDataFromHTML(r.html);if(n)return console.log("‚úÖ Server proxy successful"),n}}}catch(a){console.warn("‚ùå Server proxy not available:",a.message)}return null}static parsePlayerIdFromUrl(s){try{console.log("üîÑ Parsing player ID from URL structure");const a=s.match(/player\/(\d+)\/([^\/]+)\/(\d+)/);if(a){const[,t,r,n]=a,i=r.replace(/-/g," ").replace(/\b\w/g,o=>o.toUpperCase());return console.log(`üìù Extracted from URL: ID ${t}, Name: ${i}`),{sofifaId:parseInt(t),extractedName:i,versionId:parseInt(n),source:"url_parsing",timestamp:Date.now()}}}catch(a){console.warn("‚ùå URL parsing failed:",a.message)}return null}static parsePlayerDataFromHTML(s){try{console.log("üîç Parsing HTML for player data...");const t=new DOMParser().parseFromString(s,"text/html"),r={source:"sofifa_live",timestamp:Date.now()},n=t.querySelector(".bp-overall");n&&(r.overall=parseInt(n.textContent.trim()));const i=t.querySelector(".bp-potential");i&&(r.potential=parseInt(i.textContent.trim()));const o=t.querySelector("h1[data-title]")||t.querySelector(".player-name");o&&(r.name=o.textContent.trim());const f=t.querySelectorAll(".bp-positions .badge");f.length>0&&(r.positions=Array.from(f).map(F=>F.textContent.trim()));const h=t.querySelector(".bp-age");h&&(r.age=parseInt(h.textContent.trim()));const x=t.querySelector(".bp-club a");x&&(r.club=x.textContent.trim());const k=t.querySelector(".bp-nationality a");return k&&(r.nationality=k.textContent.trim()),r.overall||r.name?(console.log(`‚úÖ Successfully parsed player data: ${r.name||"Unknown"} (Overall: ${r.overall||"N/A"})`),r):(console.warn("‚ö†Ô∏è No meaningful data found in HTML"),null)}catch(a){return console.error("‚ùå Error parsing HTML:",a.message),null}}static clearCache(){this.cache.clear(),console.log("üóëÔ∏è SoFIFA cache cleared")}static getCacheStats(){return{size:this.cache.size,entries:Array.from(this.cache.keys()),rateLimit:this.rateLimit}}static async searchPlayerByName(s){if(!s||typeof s!="string")return null;try{if(!this.checkRateLimit())return console.warn("‚ö†Ô∏è Rate limit exceeded for SoFIFA search"),null;console.log(`üîç Searching SoFIFA for: ${s}`);const a=`https://sofifa.com/players?keyword=${encodeURIComponent(s)}`,t=[()=>this.searchWithCorsProxy(a,s),()=>this.searchWithAllowOrigins(a,s),()=>this.generateSearchResult(s)];for(const r of t)try{const n=await r();if(n)return console.log(`‚úÖ Search successful for: ${s}`),n}catch(n){console.warn(`‚ùå Search strategy failed: ${n.message}`);continue}return console.warn(`‚ö†Ô∏è All search strategies failed for: ${s}`),null}catch(a){return console.error("‚ùå Error searching SoFIFA:",a.message),null}}static async searchWithCorsProxy(s,a){const t=[`https://api.allorigins.win/get?url=${encodeURIComponent(s)}`,`https://cors-anywhere.herokuapp.com/${s}`];for(const r of t)try{console.log(`üîÑ Searching via proxy: ${r.split("/")[2]}`);const n=new AbortController,i=setTimeout(()=>n.abort(),15e3),o=await fetch(r,{method:"GET",headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"},signal:n.signal});if(clearTimeout(i),o.ok){let f=await o.text();r.includes("allorigins.win")&&(f=JSON.parse(f).contents);const h=this.parseSearchResults(f,a);if(h)return h}}catch(n){console.warn(`‚ùå Proxy search failed (${r.split("/")[2]}): ${n.message}`);continue}return null}static async searchWithAllowOrigins(s,a){try{console.log("üîÑ Trying direct search");const t=await fetch(s,{method:"GET",mode:"cors",headers:{Origin:window.location.origin,"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"}});if(t.ok){const r=await t.text(),n=this.parseSearchResults(r,a);if(n)return n}}catch(t){console.warn("‚ùå Direct search failed (expected due to CORS):",t.message)}return null}static parseSearchResults(s,a){try{const n=new DOMParser().parseFromString(s,"text/html").querySelectorAll("tbody tr[data-row]");if(n.length===0)return console.log("No player cards found in search results"),null;const i=n[0],o={source:"sofifa_search",searchName:a,timestamp:Date.now()},f=i.querySelector("a[data-tooltip]");if(f){o.name=f.textContent.trim(),o.sofifaUrl="https://sofifa.com"+f.getAttribute("href");const u=o.sofifaUrl.match(/player\/(\d+)/);u&&(o.sofifaId=parseInt(u[1]))}const h=i.querySelector(".col-oa span");h&&(o.overall=parseInt(h.textContent.trim()));const x=i.querySelectorAll(".col-name .pos");x.length>0&&(o.positions=Array.from(x).map(u=>u.textContent.trim()));const k=i.querySelector(".col-ae");k&&(o.age=parseInt(k.textContent.trim()));const F=i.querySelector(".col-team a");return F&&(o.club=F.textContent.trim()),o.name&&o.overall?(console.log(`‚úÖ Parsed search result: ${o.name} (${o.overall})`),o):null}catch(t){return console.error("‚ùå Error parsing search results:",t.message),null}}static generateSearchResult(s){return console.log(`üé≤ Generating basic search result for: ${s}`),{name:s,searchName:s,overall:70+Math.floor(Math.random()*15),source:"search_generated",timestamp:Date.now(),generated:!0}}}O(R,"CACHE_DURATION",1e3*60*60),O(R,"cache",new Map),O(R,"rateLimit",{requests:0,resetTime:0,maxRequests:10});async function oe(d,s=[]){try{return(await d()).data||s}catch(a){return ie.handleDatabaseError(a,"Data loading"),s}}async function ce(){return oe(()=>ne.getAllPlayers(),[])}class K{static async getPlayerData(s,a={useLiveData:!0,fallbackToMock:!0}){if(console.log(`üîç Searching for player: ${s}`),!s||typeof s!="string"||s.trim().length===0)return console.warn("‚ö†Ô∏è Invalid player name provided"),this.generateDefaultPlayerData("Unknown Player");const t=s.trim();let r=null;if(this.fifaDatabase[t]&&(r={...this.fifaDatabase[t],searchName:t,found:!0,source:"mock_database"},console.log(`‚úÖ Found exact match in database: ${t}`)),!r){const n=this.performFuzzyMatch(t);n&&(r={...n.data,searchName:t,suggestedName:n.name,found:!0,source:"mock_database_fuzzy"},console.log(`‚úÖ Found fuzzy match: ${t} -> ${n.name}`))}if(r&&a.useLiveData&&r.sofifaUrl)try{console.log("üåê Attempting to fetch live data from SoFIFA...");const n=await R.fetchPlayerData(r.sofifaUrl,r.sofifaId);if(n){const i={...r,...n,searchName:t,found:!0,source:"sofifa_enhanced",lastUpdated:new Date().toISOString(),mockDataAvailable:!0};return console.log(`‚úÖ Enhanced with live SoFIFA data for: ${t}`),i}else console.log("‚ö†Ô∏è Live data fetch failed, using mock data"),r.source="mock_fallback",r.sofifaAttempted=!0,r.sofifaFetchTime=new Date().toISOString()}catch(n){console.error("‚ùå Error fetching live data:",n.message),r&&(r.source="mock_error_fallback",r.fetchError=n.message)}return r||(a.fallbackToMock?(console.log(`üîÑ Generating default data for unknown player: ${t}`),this.generateDefaultPlayerData(t)):(console.log(`‚ùå No data found for player: ${t}`),null))}static performFuzzyMatch(s){const a=s.toLowerCase().split(" ");for(const[t,r]of Object.entries(this.fifaDatabase)){const i=this.normalizeString(t.toLowerCase()).split(" ");if(a.every(f=>{const h=this.normalizeString(f);return i.some(x=>x.includes(h)||h.includes(x)||this.calculateSimilarity(h,x)>.7)}))return{name:t,data:r}}return null}static normalizeString(s){return s.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^\w\s]/g,"").toLowerCase()}static calculateSimilarity(s,a){const t=s.length>a.length?s:a,r=s.length>a.length?a:s;if(t.length===0)return 1;const n=this.levenshteinDistance(t,r);return(t.length-n)/t.length}static levenshteinDistance(s,a){const t=[];for(let r=0;r<=a.length;r++)t[r]=[r];for(let r=0;r<=s.length;r++)t[0][r]=r;for(let r=1;r<=a.length;r++)for(let n=1;n<=s.length;n++)a.charAt(r-1)===s.charAt(n-1)?t[r][n]=t[r-1][n-1]:t[r][n]=Math.min(t[r-1][n-1]+1,t[r][n-1]+1,t[r-1][n]+1);return t[a.length][s.length]}static generateDefaultPlayerData(s){const a=65+Math.floor(Math.random()*15);return{overall:a,potential:Math.min(a+Math.floor(Math.random()*8),85),positions:["Unknown"],age:25,height:175+Math.floor(Math.random()*15),weight:70+Math.floor(Math.random()*15),foot:Math.random()>.5?"Right":"Left",pace:this.generateAttribute(a),shooting:this.generateAttribute(a),passing:this.generateAttribute(a),dribbling:this.generateAttribute(a),defending:this.generateAttribute(a),physical:this.generateAttribute(a),skills:this.generateDetailedSkills(a),workrates:"Medium/Medium",weakFoot:2+Math.floor(Math.random()*3),skillMoves:2+Math.floor(Math.random()*3),nationality:"Unknown",club:"Unknown",value:"‚Ç¨"+(Math.random()*5+.5).toFixed(1)+"M",wage:"‚Ç¨"+Math.floor(Math.random()*20+5)+"K",contract:"2025",sofifaId:null,sofifaUrl:null,searchName:s,found:!1,generated:!0}}static generateAttribute(s){const t=Math.max(35,s-15),r=Math.min(90,s+15);return t+Math.floor(Math.random()*(r-t))}static generateDetailedSkills(s){const a={};return["crossing","finishing","headingAccuracy","shortPassing","volleys","curve","fkAccuracy","longPassing","ballControl","acceleration","sprintSpeed","agility","reactions","balance","shotPower","jumping","stamina","strength","longShots","aggression","interceptions","positioning","vision","penalties","composure"].forEach(r=>{a[r]=this.generateAttribute(s)}),a}static getAvailablePlayers(){return Object.keys(this.fifaDatabase)}static addPlayer(s,a){this.fifaDatabase[s]=a}static hasPlayer(s){return this.fifaDatabase.hasOwnProperty(s)}static getPlayerCardColor(s){return s>=90?"fifa-card-icon bg-gradient-to-br from-purple-600 to-purple-700 text-white shadow-purple-500/30":s>=85?"fifa-card-gold bg-gradient-to-br from-yellow-400 to-yellow-500 text-yellow-900 shadow-yellow-500/30":s>=80?"fifa-card-silver bg-gradient-to-br from-gray-400 to-gray-500 text-gray-900 shadow-gray-500/30":s>=75?"fifa-card-bronze bg-gradient-to-br from-orange-400 to-orange-500 text-orange-900 shadow-orange-500/30":"fifa-card-common bg-gradient-to-br from-gray-600 to-gray-700 text-white shadow-gray-600/30"}static formatOverallRating(s){let a="";return s>=90?a="üåü":s>=85?a="ü•á":s>=80?a="ü•à":s>=75&&(a="ü•â"),`${s} ${a}`}static getRatingColor(s){return s>=85?"text-green-400":s>=75?"text-yellow-400":s>=65?"text-orange-400":"text-red-400"}static async batchGetPlayerData(s,a={}){console.log(`üì¶ Batch fetching ${s.length} players...`);const t=[],r=a.batchSize||3;for(let n=0;n<s.length;n+=r){const o=s.slice(n,n+r).map(h=>this.getPlayerData(h,a).catch(x=>({searchName:h,error:x.message,found:!1}))),f=await Promise.all(o);t.push(...f),n+r<s.length&&await new Promise(h=>setTimeout(h,1e3))}return console.log(`‚úÖ Batch fetch complete: ${t.length} players processed`),t}static async getPlayersByClub(s,a=!1){console.log(`üèüÔ∏è Searching for players from club: ${s}`);const t=Object.entries(this.fifaDatabase).filter(([r,n])=>n.club&&n.club.toLowerCase().includes(s.toLowerCase())).map(([r,n])=>({name:r,...n}));if(a){const r=t.map(n=>n.name);return await this.batchGetPlayerData(r,{useLiveData:!0})}return t.map(r=>({...r,searchName:r.name,found:!0,source:"mock_database"}))}static getSofifaStats(){const s=R.getCacheStats(),a=Object.keys(this.fifaDatabase).length,t=Object.values(this.fifaDatabase).filter(r=>r.sofifaUrl).length;return{cache:s,database:{totalPlayers:a,playersWithSofifaUrls:t,sofifaUrlCoverage:`${(t/a*100).toFixed(1)}%`},integration:{status:"active",lastCheck:new Date().toISOString()}}}static validateSofifaUrls(){console.log("üîç Validating SoFIFA URLs in database...");const s={valid:[],invalid:[],missing:[]};return Object.entries(this.fifaDatabase).forEach(([a,t])=>{t.sofifaUrl?this.isValidSofifaUrl(t.sofifaUrl)?s.valid.push({name:a,url:t.sofifaUrl,id:t.sofifaId}):s.invalid.push({name:a,url:t.sofifaUrl}):s.missing.push(a)}),console.log(`‚úÖ URL validation complete: ${s.valid.length} valid, ${s.invalid.length} invalid, ${s.missing.length} missing`),s}static isValidSofifaUrl(s){return typeof s!="string"?!1:/^https:\/\/sofifa\.com\/player\/\d+\/[^\/]+\/\d+\/?$/.test(s)}static clearAllCaches(){R.clearCache(),console.log("üóëÔ∏è All FIFA service caches cleared")}static async testSofifaConnectivity(){console.log("üß™ Testing SoFIFA connectivity...");const s=Object.entries(this.fifaDatabase).find(([r,n])=>n.sofifaUrl);if(!s)return{success:!1,error:"No players with SoFIFA URLs available for testing"};const[a,t]=s;try{const r=Date.now(),n=await R.fetchPlayerData(t.sofifaUrl,t.sofifaId),i=Date.now();return{success:!!n,testPlayer:a,responseTime:`${i-r}ms`,result:n,timestamp:new Date().toISOString()}}catch(r){return{success:!1,testPlayer:a,error:r.message,timestamp:new Date().toISOString()}}}static async getAllDatabasePlayersWithFIFA(s={useLiveData:!1}){console.log("üìã Loading all database players with FIFA enhancement...");try{const a=await ce();if(console.log(`üìä Found ${a.length} players in database`),a.length===0)return[];const t=[],r=s.batchSize||5;for(let n=0;n<a.length;n+=r){const o=a.slice(n,n+r).map(async h=>{try{const x=await this.getPlayerData(h.name,{useLiveData:s.useLiveData,fallbackToMock:!0});return{...h,fifaData:x,enhanced:!0,source:(x==null?void 0:x.source)||"database_only"}}catch(x){return console.warn(`‚ùå Failed to enhance player ${h.name}:`,x.message),{...h,fifaData:this.generateDefaultPlayerData(h.name),enhanced:!1,error:x.message}}}),f=await Promise.all(o);t.push(...f),n+r<a.length&&await new Promise(h=>setTimeout(h,500))}return console.log(`‚úÖ Enhanced ${t.length} database players with FIFA data`),t}catch(a){return console.error("‚ùå Error loading database players:",a.message),[]}}static async searchSofifaByName(s){console.log(`üîç Searching SoFIFA for player: ${s}`);try{const a=await R.searchPlayerByName(s);return a?(console.log(`‚úÖ Found player on SoFIFA: ${a.name||s}`),{...a,searchName:s,found:!0,source:"sofifa_search"}):(console.log(`‚ùå Player not found on SoFIFA: ${s}`),null)}catch(a){return console.error(`‚ùå Error searching SoFIFA for ${s}:`,a.message),null}}static async enhanceDatabasePlayer(s,a={useLiveData:!1}){console.log(`üîß Enhancing player: ${s.name}`);try{let t=await this.getPlayerData(s.name,{useLiveData:a.useLiveData,fallbackToMock:!1});return!t&&a.useLiveData&&(t=await this.searchSofifaByName(s.name)),t||(t=this.generateDefaultPlayerData(s.name),t.source="generated_default"),{...s,fifaData:t,enhanced:!0,enhancedAt:new Date().toISOString()}}catch(t){return console.error(`‚ùå Error enhancing player ${s.name}:`,t.message),{...s,fifaData:this.generateDefaultPlayerData(s.name),enhanced:!1,error:t.message}}}static async processAllStoredPlayers(s={}){const t={...{useLiveData:!0,batchSize:3,includeStatistics:!0},...s};console.log("üöÄ Processing all stored players with SoFIFA integration...");const r=Date.now();try{const n=await this.getAllDatabasePlayersWithFIFA(t),i={players:n,totalCount:n.length,processedAt:new Date().toISOString(),processingTime:`${Date.now()-r}ms`,options:t};if(t.includeStatistics){const o=this.generateProcessingStatistics(n);i.statistics=o}return console.log(`‚úÖ Completed processing ${n.length} players in ${i.processingTime}`),i}catch(n){return console.error("‚ùå Error processing stored players:",n.message),{players:[],totalCount:0,error:n.message,processedAt:new Date().toISOString(),processingTime:`${Date.now()-r}ms`}}}static generateProcessingStatistics(s){const a={total:s.length,enhanced:0,withMockData:0,withLiveData:0,withGeneratedData:0,failed:0,sourceBreakdown:{}};return s.forEach(t=>{var n;t.enhanced?a.enhanced++:a.failed++;const r=((n=t.fifaData)==null?void 0:n.source)||"unknown";a.sourceBreakdown[r]=(a.sourceBreakdown[r]||0)+1,r.includes("mock")?a.withMockData++:r.includes("sofifa")?a.withLiveData++:r.includes("generated")&&a.withGeneratedData++}),a.successRate=a.total>0?(a.enhanced/a.total*100).toFixed(1)+"%":"0%",a}}O(K,"fifaDatabase",{"Erling Haaland":{overall:91,potential:94,positions:["ST","CF"],age:23,height:195,weight:88,foot:"Left",pace:89,shooting:91,passing:65,dribbling:80,defending:45,physical:88,skills:{crossing:55,finishing:94,headingAccuracy:85,shortPassing:65,volleys:86,curve:77,fkAccuracy:84,longPassing:65,ballControl:81,acceleration:87,sprintSpeed:90,agility:77,reactions:93,balance:70,shotPower:94,jumping:95,stamina:88,strength:92,longShots:85,aggression:84,interceptions:30,positioning:95,vision:68,penalties:85,composure:88},workrates:"High/Medium",weakFoot:3,skillMoves:3,nationality:"Norway",club:"Manchester City",value:"‚Ç¨180M",wage:"‚Ç¨375K",contract:"2027",sofifaId:239085,sofifaUrl:"https://sofifa.com/player/239085/erling-haaland/250001/"},"Kylian Mbapp√©":{overall:91,potential:95,positions:["LW","ST","RW"],age:25,height:178,weight:73,foot:"Right",pace:97,shooting:89,passing:80,dribbling:92,defending:39,physical:77,skills:{crossing:80,finishing:89,headingAccuracy:78,shortPassing:83,volleys:87,curve:80,fkAccuracy:79,longPassing:75,ballControl:92,acceleration:97,sprintSpeed:97,agility:92,reactions:92,balance:84,shotPower:88,jumping:78,stamina:88,strength:76,longShots:86,aggression:78,interceptions:41,positioning:90,vision:80,penalties:80,composure:85},workrates:"High/Low",weakFoot:4,skillMoves:5,nationality:"France",club:"Real Madrid",value:"‚Ç¨180M",wage:"‚Ç¨1.2M",contract:"2029",sofifaId:231747,sofifaUrl:"https://sofifa.com/player/231747/kylian-mbappe/250001/"},"Jude Bellingham":{overall:90,potential:94,positions:["CM","CAM","CDM"],age:20,height:186,weight:75,foot:"Right",pace:75,shooting:83,passing:88,dribbling:86,defending:78,physical:82,skills:{crossing:84,finishing:82,headingAccuracy:85,shortPassing:90,volleys:80,curve:85,fkAccuracy:81,longPassing:86,ballControl:87,acceleration:78,sprintSpeed:72,agility:84,reactions:89,balance:86,shotPower:85,jumping:84,stamina:88,strength:79,longShots:84,aggression:80,interceptions:76,positioning:88,vision:89,penalties:78,composure:84},workrates:"High/High",weakFoot:4,skillMoves:4,nationality:"England",club:"Real Madrid",value:"‚Ç¨150M",wage:"‚Ç¨350K",contract:"2029",sofifaId:252371,sofifaUrl:"https://sofifa.com/player/252371/jude-bellingham/250001/"},"Vinicius Jr.":{overall:89,potential:93,positions:["LW","LM"],age:23,height:176,weight:73,foot:"Right",pace:95,shooting:83,passing:78,dribbling:92,defending:29,physical:68,skills:{crossing:81,finishing:83,headingAccuracy:62,shortPassing:80,volleys:78,curve:81,fkAccuracy:76,longPassing:76,ballControl:93,acceleration:97,sprintSpeed:93,agility:94,reactions:90,balance:82,shotPower:82,jumping:69,stamina:83,strength:53,longShots:79,aggression:56,interceptions:25,positioning:85,vision:79,penalties:75,composure:78},workrates:"High/Low",weakFoot:2,skillMoves:5,nationality:"Brazil",club:"Real Madrid",value:"‚Ç¨120M",wage:"‚Ç¨200K",contract:"2027",sofifaId:238794,sofifaUrl:"https://sofifa.com/player/238794/vinicius-junior/250001/"},"Sergio Ara√∫jo":{overall:72,potential:75,positions:["ST","CF"],age:32,height:180,weight:75,foot:"Left",pace:68,shooting:75,passing:62,dribbling:71,defending:30,physical:73,skills:{crossing:55,finishing:78,headingAccuracy:72,shortPassing:65,volleys:74,curve:68,fkAccuracy:70,longPassing:58,ballControl:73,acceleration:70,sprintSpeed:66,agility:72,reactions:76,balance:70,shotPower:76,jumping:71,stamina:72,strength:74,longShots:72,aggression:65,interceptions:25,positioning:77,vision:60,penalties:75,composure:74},workrates:"Medium/Low",weakFoot:3,skillMoves:3,nationality:"Argentina",club:"AEK Athens",value:"‚Ç¨2.8M",wage:"‚Ç¨15K",contract:"2025",sofifaId:199455,sofifaUrl:"https://sofifa.com/player/199455/sergio-araujo/250001/"},"Nordin Amrabat":{overall:70,potential:70,positions:["RW","RM","RWB"],age:37,height:173,weight:65,foot:"Right",pace:76,shooting:65,passing:73,dribbling:76,defending:61,physical:65,skills:{crossing:78,finishing:62,headingAccuracy:55,shortPassing:74,volleys:68,curve:71,fkAccuracy:75,longPassing:72,ballControl:78,acceleration:78,sprintSpeed:74,agility:80,reactions:72,balance:74,shotPower:68,jumping:58,stamina:76,strength:52,longShots:70,aggression:68,interceptions:65,positioning:68,vision:75,penalties:65,composure:74},workrates:"High/Medium",weakFoot:4,skillMoves:4,nationality:"Morocco",club:"AEK Athens",value:"‚Ç¨800K",wage:"‚Ç¨8K",contract:"2024",sofifaId:199014,sofifaUrl:"https://sofifa.com/player/199014/nordin-amrabat/250001/"},"Levi Garc√≠a":{overall:73,potential:76,positions:["LW","RW","ST"],age:26,height:175,weight:70,foot:"Left",pace:82,shooting:71,passing:68,dribbling:77,defending:35,physical:72,skills:{crossing:70,finishing:73,headingAccuracy:65,shortPassing:70,volleys:68,curve:72,fkAccuracy:67,longPassing:66,ballControl:78,acceleration:84,sprintSpeed:80,agility:81,reactions:75,balance:78,shotPower:74,jumping:68,stamina:76,strength:67,longShots:69,aggression:64,interceptions:30,positioning:74,vision:67,penalties:68,composure:72},workrates:"High/Medium",weakFoot:3,skillMoves:4,nationality:"Trinidad and Tobago",club:"AEK Athens",value:"‚Ç¨4.5M",wage:"‚Ç¨12K",contract:"2025",sofifaId:236772,sofifaUrl:"https://sofifa.com/player/236772/levi-garcia/250001/"}});const de=({player:d,isOpen:s,onClose:a})=>{const[t,r]=S.useState(null),[n,i]=S.useState(!1),[o,f]=S.useState(null),h=S.useCallback(async()=>{i(!0);try{const m=await K.getPlayerData(d.name);r(m)}catch(m){console.error("Error loading FIFA data:",m),r(null)}finally{i(!1)}},[d.name]);S.useEffect(()=>{s&&d&&h()},[s,d,h]);const x=()=>{switch(d==null?void 0:d.team){case"AEK":return"team-aek";case"Real":return"team-real";case"Ehemalige":return"team-ehemalige";default:return""}},k=()=>{switch(d==null?void 0:d.team){case"AEK":return"AEK Athens";case"Real":return"Real Madrid";case"Ehemalige":return"Former Players";default:return d==null?void 0:d.team}},F=m=>m>=85?"#10b981":m>=75?"#f59e0b":m>=65?"#f97316":"#ef4444",u=m=>m.replace(/([A-Z])/g," $1").replace(/^./,y=>y.toUpperCase()).trim(),E=m=>{f(o===m?null:m)},M=()=>{const m=typeof d.value=="number"?d.value:d.value?parseFloat(d.value):0;return e.jsxs("div",{className:"basic-info-section mb-8",children:[e.jsxs("h3",{className:"text-xl font-semibold text-white mb-4 flex items-center gap-3",children:[e.jsx("i",{className:"fas fa-user text-blue-400"}),"Basic Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Team"}),e.jsx("span",{className:`font-semibold ${x()==="team-aek"?"text-blue-400":x()==="team-real"?"text-red-400":"text-gray-400"}`,children:k()})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Position"}),e.jsx("span",{className:"text-white font-semibold",children:d.position||"Not specified"})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Market Value"}),e.jsx("span",{className:"text-green-400 font-semibold",children:m?m+"M ‚Ç¨":"Not valued"})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Goals Scored"}),e.jsx("span",{className:"text-yellow-400 font-semibold",children:d.goals||0})]})]})]})},g=()=>t?e.jsxs("div",{className:"fifa-overview grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:`fifa-card p-6 rounded-2xl text-center ${K.getPlayerCardColor(t.overall)} shadow-lg`,children:[e.jsxs("div",{className:"fifa-rating mb-3",children:[e.jsx("span",{className:"block text-4xl font-black",children:t.overall}),e.jsx("span",{className:"text-sm font-semibold uppercase tracking-wide opacity-80",children:"OVR"})]}),e.jsx("div",{className:"fifa-positions mb-3",children:t.positions.map((m,y)=>e.jsx("span",{className:"inline-block bg-black/20 px-2 py-1 rounded text-xs font-semibold mx-1",children:m},y))}),e.jsxs("div",{className:"fifa-potential pt-3 border-t border-black/20",children:[e.jsx("span",{className:"block text-2xl font-bold",children:t.potential}),e.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide opacity-80",children:"POT"})]})]}),e.jsx("div",{className:"player-details bg-white/5 rounded-lg p-6 border border-white/10",children:e.jsx("div",{className:"space-y-3",children:[{label:"Age",value:t.age},{label:"Height",value:`${t.height}cm`},{label:"Weight",value:`${t.weight}kg`},{label:"Preferred Foot",value:t.foot},{label:"Weak Foot",value:"‚≠ê".repeat(t.weakFoot)+"‚òÜ".repeat(5-t.weakFoot)},{label:"Skill Moves",value:"‚≠ê".repeat(t.skillMoves)+"‚òÜ".repeat(5-t.skillMoves)},{label:"Work Rates",value:t.workrates},...t.nationality!=="Unknown"?[{label:"Nationality",value:t.nationality}]:[],...t.value?[{label:"FIFA Value",value:t.value}]:[]].map((m,y)=>e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-white/10 last:border-b-0",children:[e.jsxs("span",{className:"text-slate-400 text-sm",children:[m.label,":"]}),e.jsx("span",{className:"text-white font-semibold text-sm",children:m.value})]},y))})})]}):null,v=()=>{if(!t)return null;const m=[{name:"Pace",value:t.pace,icon:"üèÉ"},{name:"Shooting",value:t.shooting,icon:"‚öΩ"},{name:"Passing",value:t.passing,icon:"üéØ"},{name:"Dribbling",value:t.dribbling,icon:"‚ö°"},{name:"Defending",value:t.defending,icon:"üõ°Ô∏è"},{name:"Physical",value:t.physical,icon:"üí™"}];return e.jsxs("div",{className:"fifa-attributes mb-8",children:[e.jsx("h4",{className:"text-lg font-semibold text-white mb-4",children:"Main Attributes"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:m.map((y,N)=>e.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:y.icon}),e.jsx("span",{className:"text-white font-medium",children:y.name})]}),e.jsx("span",{className:"text-white font-bold text-lg",children:y.value})]}),e.jsx("div",{className:"w-full bg-white/10 rounded-full h-2",children:e.jsx("div",{className:"h-2 rounded-full transition-all duration-500",style:{width:`${y.value}%`,backgroundColor:F(y.value)}})})]},N))})]})},p=()=>{if(!(t!=null&&t.skills))return null;const m=[{name:"Shooting",skills:["finishing","volleys","penalties","shotPower","longShots"]},{name:"Passing",skills:["vision","crossing","curve","shortPassing","longPassing"]},{name:"Movement",skills:["acceleration","sprintSpeed","agility","reactions","balance"]},{name:"Physical",skills:["jumping","stamina","strength","aggression"]},{name:"Mentality",skills:["positioning","composure","interceptions"]},{name:"Technical",skills:["ballControl","headingAccuracy","fkAccuracy"]}];return e.jsxs("div",{className:"fifa-skills",children:[e.jsx("h4",{className:"text-lg font-semibold text-white mb-4",children:"Detailed Skills"}),e.jsx("div",{className:"space-y-2",children:m.map((y,N)=>e.jsxs("div",{className:"bg-white/5 rounded-lg border border-white/10 overflow-hidden",children:[e.jsxs("button",{className:"w-full px-6 py-4 text-left flex justify-between items-center text-white font-medium hover:bg-white/5 transition-colors",onClick:()=>E(N),children:[e.jsx("span",{children:y.name}),e.jsx("i",{className:`fas fa-chevron-${o===N?"up":"down"} text-slate-400`})]}),o===N&&e.jsx("div",{className:"px-6 pb-4 border-t border-white/10",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-4",children:y.skills.filter(A=>t.skills[A]!==void 0).map(A=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-slate-400 text-sm flex-1",children:u(A)}),e.jsx("span",{className:"text-white font-semibold text-sm w-8 text-right",children:t.skills[A]}),e.jsx("div",{className:"w-16 h-2 bg-white/10 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full transition-all duration-300",style:{width:`${t.skills[A]}%`,backgroundColor:F(t.skills[A])}})})]},A))})})]},N))})]})},b=()=>e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl text-slate-600 mb-6",children:e.jsx("i",{className:"fas fa-search"})}),e.jsx("h3",{className:"text-xl font-semibold text-white mb-3",children:"FIFA Data Not Available"}),e.jsx("p",{className:"text-slate-400 mb-6 max-w-md mx-auto",children:t!=null&&t.generated?"This player was not found in our FIFA database. Showing estimated ratings.":"FIFA statistics for this player are not currently available."}),(t==null?void 0:t.generated)&&e.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-lg p-4 mx-auto max-w-md mb-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Overall:"}),e.jsxs("span",{className:"text-white",children:[t.overall," (Est.)"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Potential:"}),e.jsxs("span",{className:"text-white",children:[t.potential," (Est.)"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Height:"}),e.jsxs("span",{className:"text-white",children:[t.height,"cm (Est.)"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Foot:"}),e.jsxs("span",{className:"text-white",children:[t.foot," (Est.)"]})]})]}),e.jsxs("p",{className:"text-yellow-400 text-xs mt-3 flex items-center justify-center gap-2",children:[e.jsx("i",{className:"fas fa-exclamation-triangle"}),"These are estimated values and may not reflect actual FIFA ratings."]})]}),e.jsxs("div",{className:"text-slate-500 text-sm",children:[e.jsx("i",{className:"fas fa-info-circle mr-2"}),"FIFA ratings are sourced from ",e.jsx("a",{href:"https://sofifa.com",target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:underline",children:"SoFIFA.com"})]})]});return!s||!d?null:e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden shadow-2xl border border-white/10",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:d.name}),e.jsxs("div",{className:"flex gap-3 mt-2",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${x()==="team-aek"?"bg-blue-500/20 text-blue-300":x()==="team-real"?"bg-red-500/20 text-red-300":"bg-gray-500/20 text-gray-300"}`,children:k()}),e.jsx("span",{className:"bg-white/20 text-white px-3 py-1 rounded-full text-sm font-semibold",children:d.position||"N/A"}),(t==null?void 0:t.found)&&e.jsxs("span",{className:"bg-gradient-to-r from-yellow-400 to-yellow-500 text-yellow-900 px-3 py-1 rounded-full text-sm font-bold",children:["FIFA ",t.overall]})]})]}),e.jsx("button",{onClick:a,className:"w-10 h-10 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center text-white transition-colors",children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsx("div",{className:"p-6 max-h-[calc(90vh-120px)] overflow-y-auto",children:n?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-4xl text-blue-400 mb-4",children:e.jsx("i",{className:"fas fa-spinner fa-spin"})}),e.jsx("p",{className:"text-slate-400",children:"Loading FIFA data..."})]}):e.jsxs(e.Fragment,{children:[M(),t!=null&&t.found?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"fifa-stats-section",children:[e.jsxs("h3",{className:"text-xl font-semibold text-white mb-6 flex items-center gap-3",children:[e.jsx("i",{className:"fas fa-chart-bar text-blue-400"}),"FIFA Statistics",t.sofifaUrl&&e.jsxs("a",{href:t.sofifaUrl,target:"_blank",rel:"noopener noreferrer",className:"ml-auto bg-blue-500/10 text-blue-400 px-3 py-1 rounded-lg text-sm font-medium hover:bg-blue-500/20 transition-colors border border-blue-500/20",children:[e.jsx("i",{className:"fas fa-external-link-alt mr-2"}),"View on SoFIFA"]})]}),g(),v(),p()]})}):b()]})})]})})};function be({onNavigate:d}){const[s,a]=S.useState(null),[t,r]=S.useState(!1),[n,i]=S.useState(!1),[o,f]=S.useState(null),[h,x]=S.useState(null),[k,F]=S.useState(!1),{data:u,loading:E,error:M,refetch:g}=te("players","*"),{update:v}=se("players"),p={TH:0,IV:1,LV:2,RV:3,ZDM:4,ZM:5,ZOM:6,LM:7,RM:8,LF:9,RF:10,ST:11},b=l=>l==="TH"?"inline-block px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800 border border-green-200":["IV","LV","RV","ZDM"].includes(l)?"inline-block px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-800 border border-blue-200":["ZM","ZOM","LM","RM"].includes(l)?"inline-block px-2 py-1 rounded text-xs font-medium bg-yellow-100 text-yellow-800 border border-yellow-200":["LF","RF","ST"].includes(l)?"inline-block px-2 py-1 rounded text-xs font-medium bg-red-100 text-red-800 border border-red-200":"inline-block px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-800 border border-gray-200",m=l=>(u||[]).filter(c=>c.team===l).sort((c,j)=>(p[c.position]||99)-(p[j.position]||99)),y=l=>u?u.filter(c=>c.team===l).reduce((c,j)=>c+(j.value||0),0):0,N=l=>`${(l||0).toFixed(1)}M ‚Ç¨`,A=l=>{const c="modern-card";return l==="AEK"?`${c} border-l-4 border-blue-400`:l==="Real"?`${c} border-l-4 border-red-400`:l==="Ehemalige"?`${c} border-l-4 border-slate-400`:c},I=()=>{if(!u||u.length===0){alert("Keine Spieler f√ºr Report verf√ºgbar");return}const l=u.map(c=>`${c.name} (${c.team}): ${c.goals||0} Tore, ${c.position||"Unbekannt"}, Wert: ${N(c.value||0)}`).join(`
`);alert(`üìä Spieler-Report:

${l}`)},$=()=>{if(!u||u.length<4){D.error("üîÑ Nicht gen√ºgend Spieler f√ºr Transfer-Analyse");return}const l=m("AEK"),c=m("Real"),j=[],Z=[...l,...c].reduce((w,P)=>(w[P.position]=(w[P.position]||0)+1,w),{}),J=[{name:"Pedri Gonz√°lez",position:"ZOM",age:21,marketValue:80,eafc25:85,club:"FC Barcelona",nationality:"ESP"},{name:"Jamal Musiala",position:"LF",age:21,marketValue:100,eafc25:84,club:"Bayern M√ºnchen",nationality:"GER"},{name:"Eduardo Camavinga",position:"ZDM",age:22,marketValue:90,eafc25:83,club:"Real Madrid",nationality:"FRA"},{name:"Florian Wirtz",position:"ZOM",age:21,marketValue:85,eafc25:82,club:"Bayer Leverkusen",nationality:"GER"},{name:"Arda G√ºler",position:"RV",age:19,marketValue:25,eafc25:77,club:"Real Madrid",nationality:"TUR"},{name:"Jude Bellingham",position:"ZM",age:21,marketValue:120,eafc25:86,club:"Real Madrid",nationality:"ENG"},{name:"Gavi",position:"ZM",age:20,marketValue:60,eafc25:81,club:"FC Barcelona",nationality:"ESP"},{name:"Warren Za√Øre-Emery",position:"ZM",age:18,marketValue:40,eafc25:78,club:"PSG",nationality:"FRA"}],C=[];Object.entries({TH:1,IV:2,ZM:2,ST:2}).forEach(([w,P])=>{(Z[w]||0)<P&&C.push(w)}),C.length===0&&(l.length>c.length+1?C.push("ZM","ST"):c.length>l.length+1?C.push("ZM","IV"):C.push("ZOM","LF"));const Q=J.filter(w=>C.includes(w.position)||C.length===0).slice(0,3);if(l.length>c.length+2){const w=l.sort((P,B)=>(P.value||0)-(B.value||0))[0];j.push(`üîÑ Interner Transfer: ${w.name} von AEK zu Real`)}else if(c.length>l.length+2){const w=c.sort((P,B)=>(P.value||0)-(B.value||0))[0];j.push(`üîÑ Interner Transfer: ${w.name} von Real zu AEK`)}j.push("üåê TRANSFERMARKT.DE EMPFEHLUNGEN:"),Q.forEach((w,P)=>{j.push(`${P+1}. ${w.name} (${w.age}J) - ${w.position}
   üí∞ ${w.marketValue}M ‚Ç¨ | üéÆ EA FC 25: ${w.eafc25}
   üèÜ ${w.club} (${w.nationality})`)}),C.length>0&&j.push(`
üéØ Positions-Bedarf: ${C.join(", ")}`);const X=u.reduce((w,P)=>w+(P.value||0),0)/u.length;j.push(`
üí° Empfohlenes Budget: ~${(X*1.5).toFixed(0)}M ‚Ç¨ pro Transfer`),j.length===1&&j.push("ü§ñ Teams sind optimal ausbalanciert!"),D.success(`ü§ñ KI Transfer-Empfehlungen:

${j.join(`
`)}`,{duration:8e3})},L=l=>l==="AEK"?"text-blue-600":l==="Real"?"text-red-600":l==="Ehemalige"?"text-slate-600":"text-gray-600",U=async l=>{f(l)},T=async l=>{try{await v(l,o.id),D.success(`Spieler ${l.name} erfolgreich aktualisiert`),f(null),g()}catch(c){D.error("Fehler beim Aktualisieren des Spielers: "+c.message)}},W=l=>{x(l),F(!0)},V=()=>{F(!1),x(null)};if(E)return e.jsx(ae,{message:"Lade Kader..."});if(M)return e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-accent-red mb-4",children:e.jsx("i",{className:"fas fa-exclamation-triangle text-2xl"})}),e.jsx("p",{className:"text-text-muted mb-4",children:"Fehler beim Laden des Kaders"}),e.jsx("button",{onClick:g,className:"btn-primary",children:"Erneut versuchen"})]});const q=m("AEK"),G=m("Real"),H=m("Ehemalige"),_=[{id:"aek",name:"AEK",displayName:"AEK Athen",players:q,squadValue:y("AEK"),icon:"üîµ"},{id:"real",name:"Real",displayName:"Real Madrid",players:G,squadValue:y("Real"),icon:"üî¥"},{id:"ehemalige",name:"Ehemalige",displayName:"Ehemalige",players:H,squadValue:y("Ehemalige"),icon:"‚ö™"}];return e.jsxs("div",{className:"p-4 pb-20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-2",children:"Kader-√úbersicht"}),e.jsxs("p",{className:"text-text-muted",children:[(u==null?void 0:u.length)||0," Spieler insgesamt"]})]}),e.jsxs("div",{className:"modern-card mb-6",children:[e.jsxs("h3",{className:"font-bold text-lg mb-4 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"‚ö°"}),"Kader-Management"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:[e.jsxs("button",{onClick:I,className:"flex items-center justify-center space-x-2 bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors text-sm",children:[e.jsx("span",{children:"üìä"}),e.jsx("span",{children:"Spieler-Report"})]}),e.jsxs("button",{onClick:$,className:"flex items-center justify-center space-x-2 bg-purple-600 text-white py-3 px-4 rounded-lg hover:bg-purple-700 transition-colors text-sm",children:[e.jsx("span",{children:"ü§ñ"}),e.jsx("span",{children:"KI Transfer-Tipps"})]}),e.jsxs("button",{onClick:()=>i(!0),className:"flex items-center justify-center space-x-2 bg-red-600 text-white py-3 px-4 rounded-lg hover:bg-red-700 transition-colors text-sm",children:[e.jsx("span",{children:"‚öΩ"}),e.jsx("span",{children:"Formation Planner"})]}),e.jsxs("button",{onClick:()=>r(!0),className:"flex items-center justify-center space-x-2 bg-orange-600 text-white py-3 px-4 rounded-lg hover:bg-orange-700 transition-colors text-sm",children:[e.jsx("span",{children:"üì¶"}),e.jsx("span",{children:"Export/Import"})]}),e.jsxs("button",{onClick:()=>{const l=y("AEK")+y("Real")+y("Ehemalige"),c=u!=null&&u.length?l/u.length:0;D.success(`üìà Kader-Analyse:

Gesamtwert: ${N(l)}
Durchschnitt: ${N(c)}
Spieler gesamt: ${(u==null?void 0:u.length)||0}`,{duration:5e3})},className:"flex items-center justify-center space-x-2 bg-teal-600 text-white py-3 px-4 rounded-lg hover:bg-teal-700 transition-colors text-sm",children:[e.jsx("span",{children:"üìà"}),e.jsx("span",{children:"Kader-Analyse"})]})]})]}),e.jsx("div",{className:"space-y-4",children:_.map(l=>e.jsxs("div",{className:A(l.name),children:[e.jsx("button",{onClick:()=>a(s===l.id?null:l.id),className:"w-full text-left p-4 focus:outline-none",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-2xl",children:l.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-semibold text-lg ${L(l.name)}`,children:l.displayName}),e.jsxs("p",{className:"text-sm text-text-muted",children:[l.players.length," Spieler",l.squadValue>0&&e.jsxs("span",{className:"ml-2",children:["‚Ä¢ Kaderwert: ",N(l.squadValue)]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm text-text-muted",children:l.players.length}),e.jsx("i",{className:`fas fa-chevron-${s===l.id?"up":"down"} transition-transform`})]})]})}),s===l.id&&e.jsx("div",{className:"px-4 pb-4 border-t border-border-light mt-4 pt-4",children:l.players.length>0?e.jsx("div",{className:"grid gap-3",children:l.players.map(c=>e.jsxs("div",{className:"bg-bg-tertiary rounded-lg p-3 hover:bg-bg-secondary transition-colors cursor-pointer relative group",onClick:()=>W(c),children:[e.jsx("div",{className:"absolute top-2 right-2 text-xs bg-blue-600 text-white px-2 py-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:"üéÆ FIFA"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary group-hover:text-blue-400 transition-colors",children:c.name}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("span",{className:b(c.position),children:c.position}),c.staerke&&e.jsxs("span",{className:"text-xs text-text-muted",children:["St√§rke: ",c.staerke]}),c.value&&e.jsx("span",{className:"text-xs text-primary-green font-medium",children:N(c.value)})]}),e.jsxs("div",{className:"text-xs text-blue-400 mt-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("i",{className:"fas fa-info-circle mr-1"}),"Click for FIFA statistics"]})]})})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:j=>{j.stopPropagation(),W(c)},className:"text-blue-400 hover:text-blue-300 transition-colors p-2 rounded-full hover:bg-blue-400/10",title:"FIFA Statistics",children:e.jsx("i",{className:"fas fa-chart-bar text-sm"})}),e.jsx("button",{onClick:j=>{j.stopPropagation(),U(c)},className:"text-text-muted hover:text-primary-green transition-colors p-1",title:"Bearbeiten",children:e.jsx("i",{className:"fas fa-edit text-sm"})})]})]})]},c.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-2",children:l.icon}),e.jsxs("p",{className:"text-text-muted",children:["Keine Spieler in ",l.displayName]})]})})]},l.id))}),e.jsxs("div",{className:"mt-6 grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"modern-card text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary-green",children:(u==null?void 0:u.length)||0}),e.jsx("div",{className:"text-sm text-text-muted",children:"Gesamt Spieler"})]}),e.jsxs("div",{className:"modern-card text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-accent-orange",children:z.length}),e.jsx("div",{className:"text-sm text-text-muted",children:"Positionen"})]})]}),t&&e.jsx(re,{onClose:()=>r(!1)}),n&&e.jsx(le,{players:u||[],onClose:()=>i(!1)}),k&&h&&e.jsx(de,{player:h,isOpen:k,onClose:V}),o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Spieler bearbeiten"}),e.jsx("button",{onClick:()=>f(null),className:"text-text-muted hover:text-text-primary",children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsx(me,{player:o,onSave:T,onCancel:()=>f(null)})]})})})]})}function me({player:d,onSave:s,onCancel:a}){const[t,r]=S.useState({name:d.name||"",position:d.position||"",value:d.value||0,team:d.team||""}),n=i=>{if(i.preventDefault(),!t.name||!t.position||!t.team){D.error("Bitte alle Pflichtfelder ausf√ºllen");return}s(t)};return e.jsxs("form",{onSubmit:n,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Name *"}),e.jsx("input",{type:"text",value:t.name,onChange:i=>r({...t,name:i.target.value}),className:"w-full px-3 py-2 border border-border-light rounded-lg focus:ring-2 focus:ring-primary-green focus:border-transparent",placeholder:"Spielername",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Position *"}),e.jsxs("select",{value:t.position,onChange:i=>r({...t,position:i.target.value}),className:"w-full px-3 py-2 border border-border-light rounded-lg focus:ring-2 focus:ring-primary-green focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"Position w√§hlen"}),z.map(i=>e.jsx("option",{value:i,children:i},i))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Team *"}),e.jsxs("select",{value:t.team,onChange:i=>r({...t,team:i.target.value}),className:"w-full px-3 py-2 border border-border-light rounded-lg focus:ring-2 focus:ring-primary-green focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"Team w√§hlen"}),e.jsx("option",{value:"AEK",children:"AEK Athen"}),e.jsx("option",{value:"Real",children:"Real Madrid"}),e.jsx("option",{value:"Ehemalige",children:"Ehemalige"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Marktwert (in Millionen ‚Ç¨)"}),e.jsx("input",{type:"number",min:"0",step:"0.1",value:t.value,onChange:i=>r({...t,value:parseFloat(i.target.value)||0}),onFocus:i=>i.target.select(),className:"w-full px-3 py-2 border border-border-light rounded-lg focus:ring-2 focus:ring-primary-green focus:border-transparent",placeholder:"0.0"})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-primary-green text-white py-2 px-4 rounded-lg hover:bg-primary-green/90 transition-colors",children:"Speichern"}),e.jsx("button",{type:"button",onClick:a,className:"flex-1 bg-bg-secondary text-text-muted py-2 px-4 rounded-lg hover:bg-bg-tertiary transition-colors",children:"Abbrechen"})]})]})}export{be as default};
