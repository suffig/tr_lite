import{r as m,u as D,j as e,L as C}from"./index-CFv0wflW.js";function I({onNavigate:O}){const[f,E]=m.useState(new Set),[u,N]=m.useState("4weeks"),[h,y]=m.useState(""),[p,v]=m.useState("all"),[b,w]=m.useState("all"),{data:d,loading:F,error:z,refetch:M}=D("matches","*",{order:{column:"date",ascending:!1}}),{data:k,loading:K}=D("players","*"),T=()=>{const t=new Date;switch(u){case"1week":t.setDate(t.getDate()-7);break;case"4weeks":t.setDate(t.getDate()-28);break;case"3months":t.setMonth(t.getMonth()-3);break;default:return null}return t.toISOString().split("T")[0]},i=(()=>{if(!d)return[];let t=d;if(h)t=t.filter(l=>l.date===h);else if(u!=="all"){const l=T();l&&(t=t.filter(r=>r.date>=l))}return p!=="all"&&(t=t.filter(l=>{const r=l.goalsa||0,s=l.goalsb||0;switch(p){case"aek-wins":return r>s;case"real-wins":return s>r;default:return!0}})),b!=="all"&&(t=t.filter(l=>{const r=(l.goalsa||0)+(l.goalsb||0);switch(b){case"high-scoring":return r>=5;case"low-scoring":return r<=2;default:return!0}})),t})(),A=F||K,c=(t,l)=>{if(!k)return{name:l||"Unbekannt",value:0};const r=k.find(s=>s.id===t||s.name===l);return{name:(r==null?void 0:r.name)||l||"Unbekannt",value:(r==null?void 0:r.value)||0,team:(r==null?void 0:r.team)||"Unbekannt"}},L=t=>{const l=new Set(f);l.has(t)?l.delete(t):l.add(t),E(l)},$=()=>{if(!i)return[];const t={};return i.forEach(l=>{const r=l.date;t[r]||(t[r]=[]),t[r].push(l)}),Object.keys(t).sort((l,r)=>new Date(r)-new Date(l)).map(l=>({date:l,matches:t[l].sort((r,s)=>s.id-r.id)}))},R=t=>{const l=[{container:"border-blue-400 bg-blue-50 dark:bg-blue-900",header:"text-blue-800 dark:text-blue-100",accent:"blue-500"},{container:"border-green-500 bg-green-50 dark:bg-green-900",header:"text-green-800 dark:text-green-100",accent:"green-500"},{container:"border-purple-500 bg-purple-50 dark:bg-purple-900",header:"text-purple-800 dark:text-purple-100",accent:"purple-500"},{container:"border-red-500 bg-red-50 dark:bg-red-900",header:"text-red-800 dark:text-red-100",accent:"red-500"},{container:"border-yellow-500 bg-yellow-50 dark:bg-yellow-900",header:"text-yellow-800 dark:text-yellow-100",accent:"yellow-500"}];return l[t%l.length]};if(A)return e.jsx(C,{message:"Lade Spiele..."});if(z)return e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-accent-red mb-4",children:e.jsx("i",{className:"fas fa-exclamation-triangle text-2xl"})}),e.jsx("p",{className:"text-text-muted mb-4",children:"Fehler beim Laden der Spiele"}),e.jsx("button",{onClick:M,className:"btn-primary",children:"Erneut versuchen"})]});const g=$();return e.jsxs("div",{className:"p-4 pb-20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-2",children:e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Spiele-Ãœbersicht"})}),e.jsxs("p",{className:"text-text-muted",children:[(i==null?void 0:i.length)||0," Spiele gefunden, gruppiert nach Datum"]})]}),e.jsxs("div",{className:"mb-6 modern-card",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"ðŸ” Filter & Suche"}),e.jsx("p",{className:"text-sm text-text-muted",children:"Finde schnell die Spiele, die dich interessieren"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"ðŸ“… Zeitraum"}),e.jsxs("select",{value:u,onChange:t=>N(t.target.value),className:"w-full px-3 py-2 bg-bg-secondary border border-border-light rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-blue transition-colors",children:[e.jsx("option",{value:"1week",children:"Letzte Woche"}),e.jsx("option",{value:"4weeks",children:"Letzte 4 Wochen"}),e.jsx("option",{value:"3months",children:"Letzte 3 Monate"}),e.jsx("option",{value:"all",children:"Alle Spiele"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"ðŸ† Ergebnis"}),e.jsxs("select",{value:p,onChange:t=>v(t.target.value),className:"w-full px-3 py-2 bg-bg-secondary border border-border-light rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-blue transition-colors",children:[e.jsx("option",{value:"all",children:"Alle Ergebnisse"}),e.jsx("option",{value:"aek-wins",children:"ðŸ”µ AEK Siege"}),e.jsx("option",{value:"real-wins",children:"ðŸ”´ Real Siege"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"âš½ Tore"}),e.jsxs("select",{value:b,onChange:t=>w(t.target.value),className:"w-full px-3 py-2 bg-bg-secondary border border-border-light rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-blue transition-colors",children:[e.jsx("option",{value:"all",children:"Alle Spiele"}),e.jsx("option",{value:"high-scoring",children:"ðŸ”¥ Torreich (5+ Tore)"}),e.jsx("option",{value:"low-scoring",children:"ðŸ›¡ï¸ Torarm (â‰¤2 Tore)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"ðŸ“† Datum"}),e.jsx("input",{type:"date",value:h,onChange:t=>y(t.target.value),className:"w-full px-3 py-2 bg-bg-secondary border border-border-light rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-blue transition-colors"})]})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2 items-center justify-between",children:[e.jsx("div",{className:"text-sm text-text-muted",children:(()=>{const t=i.length,l=(d==null?void 0:d.length)||0;return t===l?`Zeige alle ${t} Spiele`:`${t} von ${l} Spielen gefiltert`})()}),e.jsx("button",{onClick:()=>{N("4weeks"),y(""),v("all"),w("all")},className:"px-4 py-2 text-sm bg-accent-orange text-white rounded-lg hover:bg-orange-600 transition-colors",children:"ðŸ”„ Filter zurÃ¼cksetzen"})]})]}),g&&g.length>0?e.jsx("div",{className:"space-y-4",children:g.map((t,l)=>{const r=R(l);return e.jsxs("div",{className:`border-2 ${r.container} rounded-lg shadow-lg`,children:[e.jsx("div",{className:"p-4 border-b border-opacity-20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-3 h-3 bg-${r.accent} rounded-full mr-3 flex-shrink-0`}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-bold ${r.header}`,children:new Date(t.date).toLocaleDateString("de-DE",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsxs("p",{className:`text-sm opacity-75 ${r.header}`,children:[t.matches.length," Spiel",t.matches.length!==1?"e":""]})]})]}),e.jsx("div",{className:`text-xs bg-${r.accent} text-white px-3 py-1 rounded-full font-semibold`,children:"Spieltag"})]})}),e.jsx("div",{className:"p-4 space-y-3",children:t.matches.map(s=>{const S=f.has(s.id);return e.jsxs("div",{className:"bg-white bg-opacity-50 rounded-lg border border-white border-opacity-30",children:[e.jsxs("button",{onClick:()=>L(s.id),className:"w-full p-4 flex items-center justify-between cursor-pointer hover:bg-opacity-80 transition-all duration-200 rounded-lg",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-bold text-text-primary",children:[s.teama||"AEK"," ",s.goalsa||0," : ",s.goalsb||0," ",s.teamb||"Real"]}),s.status&&e.jsx("span",{className:`inline-block px-2 py-1 rounded text-xs font-medium mt-1 ${s.status==="finished"?"bg-primary-green/10 text-primary-green":"bg-accent-orange/10 text-accent-orange"}`,children:s.status==="finished"?"Beendet":"Laufend"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-text-muted",children:"Details"}),e.jsx("span",{className:`text-lg transition-transform duration-200 ${S?"rotate-90":""}`,children:"â–¶"})]})]}),S&&e.jsx("div",{className:"px-4 pb-4 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold text-text-primary flex items-center",children:"âš½ TorschÃ¼tzen"}),e.jsxs("div",{className:"space-y-2",children:[(()=>{let n=[];try{typeof s.goalslista=="string"?n=JSON.parse(s.goalslista):Array.isArray(s.goalslista)&&(n=s.goalslista)}catch(a){console.warn("Failed to parse goalslista:",a),n=[]}return n&&n.length>0?e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium mb-1",children:"AEK:"}),n.map((a,j)=>{const o=typeof a=="object"&&a!==null,x=o?c(a.player_id,a.player):c(null,a);return e.jsxs("div",{className:"text-sm p-2 bg-blue-50 rounded border-l-4 border-blue-400",children:[e.jsxs("div",{className:"font-medium text-blue-800",children:[x.name,o&&a.count>1&&e.jsxs("span",{className:"ml-1 text-xs bg-blue-200 px-1 rounded",children:[a.count,"x"]})]}),e.jsxs("div",{className:"text-xs text-blue-600",children:["Marktwert: ",x.value,"M â‚¬"]})]},j)})]}):e.jsx("p",{className:"text-xs text-text-muted",children:"AEK: Keine Tore"})})(),(()=>{let n=[];try{typeof s.goalslistb=="string"?n=JSON.parse(s.goalslistb):Array.isArray(s.goalslistb)&&(n=s.goalslistb)}catch(a){console.warn("Failed to parse goalslistb:",a),n=[]}return n&&n.length>0?e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-red-600 font-medium mb-1",children:"Real:"}),n.map((a,j)=>{const o=typeof a=="object"&&a!==null,x=o?c(a.player_id,a.player):c(null,a);return e.jsxs("div",{className:"text-sm p-2 bg-red-50 rounded border-l-4 border-red-400",children:[e.jsxs("div",{className:"font-medium text-red-800",children:[x.name,o&&a.count>1&&e.jsxs("span",{className:"ml-1 text-xs bg-red-200 px-1 rounded",children:[a.count,"x"]})]}),e.jsxs("div",{className:"text-xs text-red-600",children:["Marktwert: ",x.value,"M â‚¬"]})]},j)})]}):e.jsx("p",{className:"text-xs text-text-muted",children:"Real: Keine Tore"})})()]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold text-text-primary flex items-center",children:"â­ Spieler des Spiels"}),e.jsx("div",{className:"space-y-1",children:s.manofthematch?e.jsxs("div",{className:"p-2 bg-yellow-50 rounded border-l-4 border-yellow-400",children:[e.jsx("div",{className:"font-medium text-yellow-800",children:s.manofthematch}),(()=>{const n=c(s.manofthematch_player_id,s.manofthematch);return e.jsxs("div",{className:"text-xs text-yellow-600",children:["Team: ",n.team," | Marktwert: ",n.value,"M â‚¬"]})})()]}):e.jsx("p",{className:"text-xs text-text-muted",children:"Kein Spieler des Spiels ausgewÃ¤hlt"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold text-text-primary flex items-center",children:"ðŸŸ¨ðŸŸ¥ Karten"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"AEK:"}),e.jsxs("p",{className:"text-sm text-text-muted",children:["ðŸŸ¨ ",s.yellowa||0," Gelb"]}),e.jsxs("p",{className:"text-sm text-text-muted",children:["ðŸŸ¥ ",s.reda||0," Rot"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-red-600 font-medium",children:"Real:"}),e.jsxs("p",{className:"text-sm text-text-muted",children:["ðŸŸ¨ ",s.yellowb||0," Gelb"]}),e.jsxs("p",{className:"text-sm text-text-muted",children:["ðŸŸ¥ ",s.redb||0," Rot"]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold text-text-primary flex items-center",children:"ðŸ’° Preisgelder"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-sm text-text-muted",children:[e.jsx("span",{className:"text-blue-600",children:"AEK:"})," ",s.prizeaek?`â‚¬${s.prizeaek}`:"â‚¬0"]}),e.jsxs("p",{className:"text-sm text-text-muted",children:[e.jsx("span",{className:"text-red-600",children:"Real:"})," ",s.prizereal?`â‚¬${s.prizereal}`:"â‚¬0"]})]})]})]})})]},s.id)})})]},t.date)})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-text-muted mb-4",children:e.jsx("i",{className:"fas fa-futbol text-4xl opacity-50"})}),e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"Keine Spiele gefunden"}),e.jsx("p",{className:"text-text-muted",children:"Es wurden noch keine Spiele hinzugefÃ¼gt."})]}),e.jsx("div",{className:"mt-6 modern-card bg-blue-50 border-blue-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-blue-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-1",children:"Hinweis"}),e.jsx("p",{className:"text-blue-700 text-sm",children:"Klicken Sie auf ein Spiel, um detaillierte Statistiken wie TorschÃ¼tzen, Karten und Preisgelder anzuzeigen. Neue Spiele kÃ¶nnen im Verwaltungsbereich hinzugefÃ¼gt werden."})]})]})})]})}export{I as default};
