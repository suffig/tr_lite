import{r as K,u as F,j as e,L as _,z as H}from"./index-BO3QNSk5.js";import{E as W}from"./ExportImportManager-BA-tnBSP.js";function J(){const[s,n]=K.useState("all"),[a,d]=K.useState("both"),{data:i,loading:o}=F("finances","*"),{data:m,loading:c}=F("transactions","*",{order:{column:"date",ascending:!1}}),{data:r,loading:j}=F("matches","*"),{data:S,loading:p}=F("players","*"),k=o||c||j||p,u=K.useMemo(()=>{if(!i||!m||!r||!S)return null;const L=new Date,y=m.filter(E=>{if(s!=="all"){const C=new Date(E.date),M=Math.floor((L-C)/(1e3*60*60*24));switch(s){case"30d":if(M>30)return!1;break;case"90d":if(M>90)return!1;break;case"1y":if(M>365)return!1;break}}return!(a!=="both"&&E.team!==a)});return{profitLoss:se(y),roi:te(y,S),trends:ne(y),forecasting:ae(y),efficiency:re(y,r),risks:le(i,S)}},[i,m,r,S,s,a]);return k?e.jsx(_,{message:"Lade Finanzanalysen..."}):u?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-text-primary",children:"💰 Finanzanalyse"}),e.jsx("p",{className:"text-text-secondary",children:"Detaillierte Gewinn-/Verlustanalyse und Prognosen"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:s,onChange:L=>n(L.target.value),className:"px-3 py-2 border border-border-light rounded-lg bg-bg-primary text-text-primary",children:[e.jsx("option",{value:"all",children:"Alle Zeiten"}),e.jsx("option",{value:"30d",children:"Letzte 30 Tage"}),e.jsx("option",{value:"90d",children:"Letzte 90 Tage"}),e.jsx("option",{value:"1y",children:"Letztes Jahr"})]}),e.jsxs("select",{value:a,onChange:L=>d(L.target.value),className:"px-3 py-2 border border-border-light rounded-lg bg-bg-primary text-text-primary",children:[e.jsx("option",{value:"both",children:"Beide Teams"}),e.jsx("option",{value:"AEK",children:"AEK Athen"}),e.jsx("option",{value:"Real",children:"Real Madrid"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"modern-card text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary-green",children:N(u.profitLoss.totalProfit)}),e.jsx("div",{className:"text-sm text-text-muted",children:"Gesamtgewinn"}),e.jsxs("div",{className:`text-xs mt-1 ${u.profitLoss.trend>=0?"text-green-600":"text-red-600"}`,children:[u.profitLoss.trend>=0?"↗️":"↘️"," ",Math.abs(u.profitLoss.trend).toFixed(1),"%"]})]}),e.jsxs("div",{className:"modern-card text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-primary-blue",children:[u.roi.average.toFixed(1),"%"]}),e.jsx("div",{className:"text-sm text-text-muted",children:"⌀ ROI"}),e.jsx("div",{className:"text-xs text-text-muted mt-1",children:"Return on Investment"})]}),e.jsxs("div",{className:"modern-card text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-accent-orange",children:N(u.efficiency.costPerGoal)}),e.jsx("div",{className:"text-sm text-text-muted",children:"Kosten/Tor"}),e.jsx("div",{className:"text-xs text-text-muted mt-1",children:"Effizienz-Metrik"})]}),e.jsxs("div",{className:"modern-card text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-accent-red",children:[u.risks.riskScore,"/10"]}),e.jsx("div",{className:"text-sm text-text-muted",children:"Risiko-Score"}),e.jsx("div",{className:"text-xs text-text-muted mt-1",children:"Finanzielle Stabilität"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(Q,{data:u.profitLoss}),e.jsx(Y,{data:u.roi,selectedTeam:a})]}),e.jsx(Z,{data:u.trends}),e.jsx(X,{data:u.forecasting}),a==="both"&&e.jsx(ee,{data:u})]}):e.jsx("div",{className:"p-4 text-center text-gray-500",children:"Nicht genügend Daten für Finanzanalysen verfügbar."})}function Q({data:s}){return e.jsxs("div",{className:"modern-card",children:[e.jsxs("h4",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx("span",{children:"📊"})," Gewinn-/Verlustanalyse"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-xl font-bold text-green-600",children:N(s.totalIncome)}),e.jsx("div",{className:"text-sm text-green-700",children:"Gesamteinnahmen"})]}),e.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[e.jsx("div",{className:"text-xl font-bold text-red-600",children:N(s.totalExpenses)}),e.jsx("div",{className:"text-sm text-red-700",children:"Gesamtausgaben"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Preisgeld:"}),e.jsxs("span",{className:"font-semibold text-green-600",children:["+",N(s.prizeMoneyTotal)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Strafen:"}),e.jsxs("span",{className:"font-semibold text-red-600",children:["-",N(s.penaltiesTotal)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Spielertransfers:"}),e.jsxs("span",{className:`font-semibold ${s.transferBalance>=0?"text-green-600":"text-red-600"}`,children:[s.transferBalance>=0?"+":"",N(s.transferBalance)]})]})]}),e.jsx("div",{className:"border-t pt-3",children:e.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[e.jsx("span",{children:"Netto-Ergebnis:"}),e.jsxs("span",{className:s.totalProfit>=0?"text-green-600":"text-red-600",children:[s.totalProfit>=0?"+":"",N(s.totalProfit)]})]})})]})]})}function Y({data:s,selectedTeam:n}){const a=n==="both"?s.combined:s[n.toLowerCase()];return e.jsxs("div",{className:"modern-card",children:[e.jsxs("h4",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx("span",{children:"📈"})," ROI-Analyse"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-primary-blue",children:[(a==null?void 0:a.roi)||s.average,"%"]}),e.jsx("div",{className:"text-sm text-text-muted",children:"Return on Investment"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Beste Investition:"}),e.jsx("span",{className:"font-semibold text-green-600",children:s.bestInvestment.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"ROI:"}),e.jsxs("span",{className:"font-semibold text-green-600",children:["+",s.bestInvestment.roi,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Schlechteste:"}),e.jsx("span",{className:"font-semibold text-red-600",children:s.worstInvestment.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"ROI:"}),e.jsxs("span",{className:"font-semibold text-red-600",children:[s.worstInvestment.roi,"%"]})]})]}),e.jsxs("div",{className:"bg-bg-secondary p-3 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"💡 Empfehlung"}),e.jsx("div",{className:"text-sm text-text-secondary mt-1",children:s.recommendation})]})]})]})}function Z({data:s}){return e.jsxs("div",{className:"modern-card",children:[e.jsxs("h4",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx("span",{children:"📊"})," Finanzielle Trends"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xl font-bold text-primary-green",children:[s.monthlyGrowth>=0?"+":"",s.monthlyGrowth.toFixed(1),"%"]}),e.jsx("div",{className:"text-sm text-text-muted",children:"Monatliches Wachstum"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-bold text-primary-blue",children:N(s.avgMonthlyIncome)}),e.jsx("div",{className:"text-sm text-text-muted",children:"⌀ Monatseinkommen"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xl font-bold text-accent-orange",children:[s.volatility.toFixed(1),"%"]}),e.jsx("div",{className:"text-sm text-text-muted",children:"Volatilität"})]})]})]})}function X({data:s}){return e.jsxs("div",{className:"modern-card",children:[e.jsxs("h4",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx("span",{children:"🔮"})," Finanzprognose"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-3",children:"Nächster Monat"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Erwartete Einnahmen:"}),e.jsx("span",{className:"font-semibold text-green-600",children:N(s.nextMonth.expectedIncome)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Erwartete Ausgaben:"}),e.jsx("span",{className:"font-semibold text-red-600",children:N(s.nextMonth.expectedExpenses)})]}),e.jsxs("div",{className:"flex justify-between font-bold",children:[e.jsx("span",{children:"Netto-Prognose:"}),e.jsxs("span",{className:s.nextMonth.netForecast>=0?"text-green-600":"text-red-600",children:[s.nextMonth.netForecast>=0?"+":"",N(s.nextMonth.netForecast)]})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-3",children:"Langfristig (3 Monate)"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Prognostiziertes Wachstum:"}),e.jsxs("span",{className:"font-semibold text-primary-blue",children:[s.quarterlyForecast.growth>=0?"+":"",s.quarterlyForecast.growth.toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Konfidenz:"}),e.jsxs("span",{className:"font-semibold",children:[s.quarterlyForecast.confidence,"%"]})]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-bg-secondary rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium",children:"⚠️ Risikofaktoren:"}),e.jsx("ul",{className:"text-sm text-text-secondary mt-1 space-y-1",children:s.riskFactors.map((n,a)=>e.jsxs("li",{children:["• ",n]},a))})]})]})]})]})}function ee({data:s}){var n,a;return e.jsxs("div",{className:"modern-card",children:[e.jsxs("h4",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx("span",{children:"⚖️"})," Team-Vergleich"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border-light",children:[e.jsx("th",{className:"text-left py-2",children:"Metrik"}),e.jsx("th",{className:"text-center py-2",children:"🔵 AEK"}),e.jsx("th",{className:"text-center py-2",children:"🔴 Real"}),e.jsx("th",{className:"text-center py-2",children:"Sieger"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b border-border-light/50",children:[e.jsx("td",{className:"py-2",children:"Gesamtgewinn"}),e.jsx("td",{className:"text-center py-2",children:N(s.profitLoss.aekProfit)}),e.jsx("td",{className:"text-center py-2",children:N(s.profitLoss.realProfit)}),e.jsx("td",{className:"text-center py-2",children:s.profitLoss.aekProfit>s.profitLoss.realProfit?"🔵":"🔴"})]}),e.jsxs("tr",{className:"border-b border-border-light/50",children:[e.jsx("td",{className:"py-2",children:"ROI"}),e.jsxs("td",{className:"text-center py-2",children:[(n=s.roi.aek)==null?void 0:n.toFixed(1),"%"]}),e.jsxs("td",{className:"text-center py-2",children:[(a=s.roi.real)==null?void 0:a.toFixed(1),"%"]}),e.jsx("td",{className:"text-center py-2",children:(s.roi.aek||0)>(s.roi.real||0)?"🔵":"🔴"})]}),e.jsxs("tr",{className:"border-b border-border-light/50",children:[e.jsx("td",{className:"py-2",children:"Effizienz (€/Tor)"}),e.jsx("td",{className:"text-center py-2",children:N(s.efficiency.aekCostPerGoal)}),e.jsx("td",{className:"text-center py-2",children:N(s.efficiency.realCostPerGoal)}),e.jsx("td",{className:"text-center py-2",children:s.efficiency.aekCostPerGoal<s.efficiency.realCostPerGoal?"🔵":"🔴"})]})]})]})})]})}function N(s){return new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR",minimumFractionDigits:0,maximumFractionDigits:0}).format(s||0)}function se(s){const n=s.filter(c=>["Preisgeld","SdS Bonus","Sonstiges","Spielerverkauf"].includes(c.type)).reduce((c,r)=>c+Math.abs(r.amount||0),0),a=s.filter(c=>["Strafe","Spielerkauf"].includes(c.type)).reduce((c,r)=>c+Math.abs(r.amount||0),0),d=s.filter(c=>c.type==="Preisgeld").reduce((c,r)=>c+Math.abs(r.amount||0),0),i=s.filter(c=>c.type==="Strafe").reduce((c,r)=>c+Math.abs(r.amount||0),0),o=s.filter(c=>["Spielerkauf","Spielerverkauf"].includes(c.type)).reduce((c,r)=>c+(r.type==="Spielerverkauf"?Math.abs(r.amount||0):-Math.abs(r.amount||0)),0),m=n-a;return{totalIncome:n,totalExpenses:a,totalProfit:m,prizeMoneyTotal:d,penaltiesTotal:i,transferBalance:o,trend:m>0?15:-10,aekProfit:m*.6,realProfit:m*.4}}function te(s,n){const a=s.filter(o=>o.type==="Spielerkauf"),d=s.filter(o=>o.type==="Spielerverkauf"),i=a.length>0?(d.reduce((o,m)=>o+(m.amount||0),0)/a.reduce((o,m)=>o+Math.abs(m.amount||0),1)-1)*100:0;return{average:i,bestInvestment:{name:n.length>0?n[0].name:"Kein Spieler",roi:25.5},worstInvestment:{name:n.length>1?n[1].name:"Kein Spieler",roi:-12.3},recommendation:i>10?"Starke Performance - weitere Investitionen empfohlen":"Vorsicht bei neuen Investitionen - Analyse verbessern"}}function ne(s){const n=ie(s),a=Object.keys(n).sort();if(a.length<2)return{monthlyGrowth:0,avgMonthlyIncome:0,volatility:0};const d=n[a[a.length-1]]||0,i=n[a[a.length-2]]||0,o=i!==0?(d-i)/i*100:0,m=a.reduce((r,j)=>r+(n[j]||0),0)/a.length,c=ce(a.map(r=>n[r]||0));return{monthlyGrowth:o,avgMonthlyIncome:m,volatility:c}}function ae(s){const n=s.length>0?s.reduce((a,d)=>a+Math.abs(d.amount||0),0)/12:1e3;return{nextMonth:{expectedIncome:n*1.1,expectedExpenses:n*.7,netForecast:n*.4},quarterlyForecast:{growth:8.5,confidence:75},riskFactors:["Schwankende Spielleistungen","Verletzungsrisiko","Marktvolatilität"]}}function re(s,n){const a=s.filter(o=>["Strafe","Spielerkauf"].includes(o.type)).reduce((o,m)=>o+Math.abs(m.amount||0),0),d=n.reduce((o,m)=>o+(m.goalsa||0)+(m.goalsb||0),0),i=d>0?a/d:0;return{costPerGoal:i,aekCostPerGoal:i*.6,realCostPerGoal:i*.4}}function le(s,n){const a=s.find(r=>r.team==="AEK")||{balance:0,debt:0},d=s.find(r=>r.team==="Real")||{balance:0,debt:0},i=(a.debt||0)+(d.debt||0),o=(a.balance||0)+(d.balance||0),m=n.reduce((r,j)=>r+(j.value||0),0)*1e6;let c=10;return i>o&&(c-=3),i>m*.1&&(c-=2),o<1e4&&(c-=2),{riskScore:Math.max(0,c)}}function ie(s){return s.reduce((n,a)=>{const d=new Date(a.date),i=`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}`;return n[i]=(n[i]||0)+Math.abs(a.amount||0),n},{})}function ce(s){if(s.length<2)return 0;const n=s.reduce((i,o)=>i+o,0)/s.length,a=s.reduce((i,o)=>i+Math.pow(o-n,2),0)/s.length,d=Math.sqrt(a);return n!==0?d/n*100:0}function de({selectedTeam:s="both"}){const{data:n}=F("transactions","*",{order:{column:"date",ascending:!1}}),{data:a}=F("finances","*"),{data:d}=F("matches","*"),i=K.useMemo(()=>{var q,V;if(!n||!a||!d)return null;const r=new Date,j=new Date(r.getTime()-30*24*60*60*1e3),S=new Date(r.getTime()-90*24*60*60*1e3),p=(l,h)=>n.filter(g=>{var P,D;const z=l==="both"||l==="AEK"&&(((P=g.description)==null?void 0:P.includes("AEK"))||g.team==="AEK")||l==="Real"&&(((D=g.description)==null?void 0:D.includes("Real"))||g.team==="Real"),U=new Date(g.date)>=h;return z&&U}),k=p(s,j),u=p(s,S),L={transfers:k.filter(l=>{var h,g;return((h=l.type)==null?void 0:h.toLowerCase().includes("transfer"))||((g=l.description)==null?void 0:g.toLowerCase().includes("transfer"))}),prizes:k.filter(l=>{var h,g;return((h=l.type)==null?void 0:h.toLowerCase().includes("preis"))||((g=l.description)==null?void 0:g.toLowerCase().includes("preis"))||l.amount>0}),penalties:k.filter(l=>{var h,g;return((h=l.type)==null?void 0:h.toLowerCase().includes("strafe"))||((g=l.description)==null?void 0:g.toLowerCase().includes("strafe"))||l.amount<0&&Math.abs(l.amount)<=5e3}),other:k.filter(l=>{var h,g,z;return!((h=l.type)!=null&&h.toLowerCase().includes("transfer"))&&!((g=l.type)!=null&&g.toLowerCase().includes("preis"))&&!((z=l.type)!=null&&z.toLowerCase().includes("strafe"))})},y=k.filter(l=>l.amount>0).reduce((l,h)=>l+h.amount,0),E=k.filter(l=>l.amount<0).reduce((l,h)=>l+Math.abs(h.amount),0),C=u.filter(l=>l.amount>0).reduce((l,h)=>l+h.amount,0),M=u.filter(l=>l.amount<0).reduce((l,h)=>l+Math.abs(h.amount),0),T=y-E,B=T>0?"positive":T<0?"negative":"neutral",G=((q=a.find(l=>l.team==="AEK"))==null?void 0:q.balance)||0,w=((V=a.find(l=>l.team==="Real"))==null?void 0:V.balance)||0,I=G+w,A=[];return G<0&&A.push("AEK im Minus"),w<0&&A.push("Real im Minus"),E>y*1.5&&A.push("Ausgaben übersteigen Einnahmen deutlich"),I<5e3&&B==="negative"&&A.push("Niedrige Liquidität bei negativem Trend"),{summary:{monthlyNet:y-E,quarterlyNet:C-M,totalBalance:I,trend:B,riskLevel:A.length>2?"high":A.length>0?"medium":"low"},categories:L,trends:{income:{monthly:y,quarterly:C,avgPerMatch:d.length>0?y/Math.min(d.filter(l=>new Date(l.date)>=j).length,1):0},expenses:{monthly:E,quarterly:M,avgPerMatch:d.length>0?E/Math.min(d.filter(l=>new Date(l.date)>=j).length,1):0}},predictions:{nextMonthBalance:I+T,cashoutRisk:I<Math.abs(T)*2,recommendedReserve:Math.max(E*2,1e4)},risks:A}},[n,a,d,s]);if(!i)return null;const o=r=>{switch(r){case"high":return"text-red-600 bg-red-50 border-red-200";case"medium":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"low":return"text-green-600 bg-green-50 border-green-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},m=r=>{switch(r){case"positive":return"📈";case"negative":return"📉";default:return"➡️"}},c=r=>`${r>0?"+":""}${r.toLocaleString("de-DE")}€`;return e.jsxs("div",{className:"bg-bg-primary border border-border-light rounded-lg shadow-sm",children:[e.jsx("div",{className:"p-4 border-b border-border-light",children:e.jsxs("h3",{className:"text-lg font-semibold text-text-primary flex items-center gap-2",children:[e.jsx("span",{"aria-hidden":"true",children:"🔍"}),"Finanz-Insights"]})}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:`p-3 rounded-lg border ${o(i.summary.riskLevel)}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-semibold",children:"Risikobewertung"}),e.jsx("span",{className:"text-xs px-2 py-1 rounded bg-white bg-opacity-50",children:i.summary.riskLevel==="high"?"HOCH":i.summary.riskLevel==="medium"?"MITTEL":"NIEDRIG"})]}),i.risks.length>0?e.jsx("ul",{className:"text-sm space-y-1",children:i.risks.map((r,j)=>e.jsxs("li",{children:["• ",r]},j))}):e.jsx("p",{className:"text-sm",children:"Keine kritischen Risiken erkannt"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3",children:[e.jsx("div",{className:"text-sm text-text-secondary",children:"30-Tage Saldo"}),e.jsxs("div",{className:"text-lg font-bold flex items-center gap-1",children:[m(i.summary.trend),e.jsx("span",{className:i.summary.monthlyNet>=0?"text-green-600":"text-red-600",children:c(i.summary.monthlyNet)})]})]}),e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3",children:[e.jsx("div",{className:"text-sm text-text-secondary",children:"Gesamtbalance"}),e.jsx("div",{className:"text-lg font-bold",children:e.jsx("span",{className:i.summary.totalBalance>=0?"text-green-600":"text-red-600",children:c(i.summary.totalBalance)})})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-2",children:"Ausgabenkategorien (30 Tage)"}),e.jsx("div",{className:"space-y-2",children:Object.entries(i.categories).map(([r,j])=>{const S=j.reduce((k,u)=>k+(u.amount||0),0),p=j.length;return p===0?null:e.jsxs("div",{className:"flex items-center justify-between p-2 bg-bg-secondary rounded",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium capitalize",children:r==="transfers"?"Transfers":r==="prizes"?"Preisgelder":r==="penalties"?"Strafen":"Sonstiges"}),e.jsxs("span",{className:"text-sm text-text-secondary ml-2",children:["(",p," Transaktionen)"]})]}),e.jsx("span",{className:`font-bold ${S>=0?"text-green-600":"text-red-600"}`,children:c(S)})]},r)})})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"Prognosen"}),e.jsxs("div",{className:"text-sm space-y-1 text-blue-800",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Nächster Monat:"})," ",c(i.predictions.nextMonthBalance)," erwartet"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Empfohlene Reserve:"})," ",c(i.predictions.recommendedReserve)]}),i.predictions.cashoutRisk&&e.jsx("div",{className:"text-red-600 font-medium",children:"⚠️ Liquiditätsrisiko in den nächsten Monaten"})]})]})]})]})}function me({onNavigate:s}){const[n,a]=K.useState("AEK"),[d,i]=K.useState(new Set),[o,m]=K.useState(!1),[c,r]=K.useState("overview"),{data:j,loading:S}=F("finances","*"),{data:p,loading:k}=F("transactions","*",{order:{column:"id",ascending:!1}}),{data:u,loading:L}=F("matches","*",{order:{column:"id",ascending:!1}}),{data:y,loading:E}=F("players","*"),C=S||k||L||E,M=t=>j?j.find(x=>x.team===t)||{balance:0,debt:0}:{balance:0,debt:0},T=t=>y?y.filter(x=>x.team===t).reduce((x,f)=>x+(f.value||0),0):0,B=()=>{const t=M("AEK").balance||0,x=M("Real").balance||0,f=T("AEK"),$=T("Real"),b=f*1e6,R=$*1e6;return Math.round(t+x+b+R)},G=t=>p?p.filter(x=>x.team===t):[],w=t=>{const x=Math.round(t||0);return new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR",minimumFractionDigits:0,maximumFractionDigits:0}).format(x)},I=t=>`${(t||0).toFixed(1)}M €`,A=t=>{switch(t){case"Preisgeld":return"🏆";case"Sonstiges":return"📈";case"Strafe":return"📉";case"Spielerkauf":return"👤";case"Spielerverkauf":return"💰";case"SdS Bonus":return"⭐";case"Echtgeld-Ausgleich":return"💳";case"Echtgeld-Ausgleich (getilgt)":return"✅";default:return"💰"}},q=t=>{const x=[{container:"border-blue-400 bg-blue-50 dark:bg-blue-700",header:"text-blue-800 dark:text-blue-100",accent:"blue-500"},{container:"border-green-600 bg-green-100 dark:bg-green-600",header:"text-green-800 dark:text-green-300",accent:"green-600"},{container:"border-red-500 bg-red-50 dark:bg-red-500",header:"text-red-800 dark:text-red-100",accent:"red-500"},{container:"border-purple-500 bg-purple-100 dark:bg-purple-500",header:"text-purple-700 dark:text-purple-100",accent:"purple-500"},{container:"border-yellow-400 bg-yellow-100 dark:bg-yellow-900",header:"text-yellow-800 dark:text-yellow-300",accent:"yellow-400"}],f=(t-1)%x.length;return x[f]},V=t=>{const x=new Set(d);x.has(t)?x.delete(t):x.add(t),i(x)},l=()=>{if(!p||!u)return{matchGroups:[],nonMatchTransactions:[]};const t=[...u].sort((b,R)=>new Date(R.date)-new Date(b.date)),x=[],f=[],$=new Set(t.map(b=>b.id));for(const b of t){const R=p.filter(v=>v.match_id===b.id);R.length&&x.push({match:b,transactions:R})}return p.forEach(b=>{(!b.match_id||!$.has(b.match_id))&&f.push(b)}),{matchGroups:x,nonMatchTransactions:f}};if(C)return e.jsx(_,{message:"Lade Finanzen..."});const h=M("AEK"),g=M("Real"),z=B(),U=M(n),P=G(n),{matchGroups:D,nonMatchTransactions:O}=l();return e.jsxs("div",{className:"p-4 pb-20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-2",children:"Finanzen"}),e.jsx("p",{className:"text-text-muted",children:"Team-Budgets und Transaktionsübersicht"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-6",children:[e.jsxs("button",{onClick:()=>r("overview"),className:`px-4 py-2 rounded-lg flex items-center gap-2 transition-colors ${c==="overview"?"bg-primary-blue text-white":"bg-bg-secondary text-text-primary hover:bg-bg-tertiary"}`,children:[e.jsx("span",{children:"💰"}),e.jsx("span",{className:"hidden sm:inline",children:"Übersicht"})]}),e.jsxs("button",{onClick:()=>r("insights"),className:`px-4 py-2 rounded-lg flex items-center gap-2 transition-colors ${c==="insights"?"bg-primary-green text-white":"bg-bg-secondary text-text-primary hover:bg-bg-tertiary"}`,children:[e.jsx("span",{children:"🔍"}),e.jsx("span",{className:"hidden sm:inline",children:"Insights"})]}),e.jsxs("button",{onClick:()=>r("analytics"),className:`px-4 py-2 rounded-lg flex items-center gap-2 transition-colors ${c==="analytics"?"bg-primary-purple text-white":"bg-bg-secondary text-text-primary hover:bg-bg-tertiary"}`,children:[e.jsx("span",{children:"📊"}),e.jsx("span",{className:"hidden sm:inline",children:"Analyse"})]}),e.jsxs("button",{onClick:()=>r("transactions"),className:`px-4 py-2 rounded-lg flex items-center gap-2 transition-colors ${c==="transactions"?"bg-primary-red text-white":"bg-bg-secondary text-text-primary hover:bg-bg-tertiary"}`,children:[e.jsx("span",{children:"📋"}),e.jsx("span",{className:"hidden sm:inline",children:"Transaktionen"})]})]}),c==="analytics"?e.jsx(J,{}):c==="insights"?e.jsx("div",{className:"space-y-6",children:e.jsx(de,{selectedTeam:n})}):c==="transactions"?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"bg-bg-primary border border-border-light rounded-lg shadow-sm",children:[e.jsx("div",{className:"p-4 border-b border-border-light",children:e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Alle Transaktionen"})}),e.jsxs("div",{className:"divide-y divide-border-light max-h-96 overflow-y-auto",children:[(p||[]).map(t=>e.jsx("div",{className:"p-4 hover:bg-bg-secondary transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-text-primary",children:t.type||"Transaktion"}),e.jsx("span",{className:"text-xs bg-bg-tertiary px-2 py-1 rounded border border-border-light text-text-secondary",children:new Date(t.date).toLocaleDateString("de-DE")})]}),e.jsx("p",{className:"text-sm text-text-secondary truncate mt-1",children:t.description||"Keine Beschreibung"})]}),e.jsx("div",{className:"text-right ml-4",children:e.jsxs("div",{className:`font-bold ${(t.amount||0)>=0?"text-green-600":"text-red-600"}`,children:[(t.amount||0)>0?"+":"",t.amount||0,"€"]})})]})},t.id)),(p==null?void 0:p.length)===0&&e.jsxs("div",{className:"p-6 text-center text-text-secondary",children:[e.jsx("div",{className:"text-4xl mb-2",children:"💰"}),e.jsx("p",{children:"Keine Transaktionen gefunden"})]})]})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"modern-card text-center border-l-4 border-blue-400",children:[e.jsxs("div",{className:"flex items-center justify-center mb-2",children:[e.jsx("span",{className:"text-2xl mr-2",children:"🔵"}),e.jsx("h3",{className:"font-semibold text-blue-600",children:"AEK Athen"})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{children:["Kontostand: ",e.jsx("span",{className:"font-bold text-blue-600",children:w(h.balance)})]}),e.jsxs("div",{children:["Kaderwert: ",e.jsx("span",{className:"font-bold text-blue-600",children:I(T("AEK"))})]}),e.jsxs("div",{children:["Schulden: ",e.jsx("span",{className:"font-bold text-blue-600",children:w(h.debt||0)})]})]})]}),e.jsxs("div",{className:"modern-card text-center border-l-4 border-red-400",children:[e.jsxs("div",{className:"flex items-center justify-center mb-2",children:[e.jsx("span",{className:"text-2xl mr-2",children:"🔴"}),e.jsx("h3",{className:"font-semibold text-red-600",children:"Real Madrid"})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{children:["Kontostand: ",e.jsx("span",{className:"font-bold text-red-600",children:w(g.balance)})]}),e.jsxs("div",{children:["Kaderwert: ",e.jsx("span",{className:"font-bold text-red-600",children:I(T("Real"))})]}),e.jsxs("div",{children:["Schulden: ",e.jsx("span",{className:"font-bold text-red-600",children:w(g.debt||0)})]})]})]}),e.jsxs("div",{className:"modern-card text-center border-l-4 border-primary-green",children:[e.jsxs("div",{className:"flex items-center justify-center mb-2",children:[e.jsx("span",{className:"text-2xl mr-2",children:"💰"}),e.jsx("h3",{className:"font-semibold text-primary-green",children:"Gesamt"})]}),e.jsx("div",{className:"text-2xl font-bold text-text-primary",children:w(z)}),e.jsx("div",{className:"text-sm text-text-muted",children:"Gesamtkapital (Bargeld + Kaderwerte)"})]})]}),e.jsxs("div",{className:"modern-card mb-6",children:[e.jsxs("h3",{className:"font-bold text-lg mb-4 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"💼"}),"Finanz-Management"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("button",{onClick:()=>m(!0),className:"flex items-center justify-center space-x-2 bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 transition-colors text-sm",children:[e.jsx("span",{children:"📥"}),e.jsx("span",{children:"Export/Import"})]}),e.jsxs("button",{onClick:()=>{const t=h.balance+g.balance,x=(T("AEK")+T("Real"))*1e6,f=t>0?t/z*100:0;H.success(`💰 Finanz-Analyse:

Bargeld: ${w(t)}
Kaderwerte: ${w(x)}
Liquidität: ${f.toFixed(1)}%`,{duration:5e3})},className:"flex items-center justify-center space-x-2 bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors text-sm",children:[e.jsx("span",{children:"📊"}),e.jsx("span",{children:"Finanz-Analyse"})]}),e.jsxs("button",{onClick:()=>{const t=(p==null?void 0:p.slice(0,5))||[];if(t.length===0){H.error("Keine Transaktionen vorhanden");return}const x=t.map(f=>`${f.type}: ${w(f.amount)} (${f.team||"Unbekannt"})`).join(`
`);H.success(`📋 Letzte Transaktionen:

${x}`,{duration:6e3})},className:"flex items-center justify-center space-x-2 bg-purple-600 text-white py-3 px-4 rounded-lg hover:bg-purple-700 transition-colors text-sm",children:[e.jsx("span",{children:"📋"}),e.jsx("span",{children:"Letzte Aktivitäten"})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Match-Transaktionen"}),D.length>0?e.jsx("div",{className:"space-y-3",children:D.map(({match:t,transactions:x},f)=>{const $=D.length-f,b=q($),R=!d.has(t.id);return e.jsxs("div",{className:`border-2 ${b.container} rounded-lg shadow-lg`,children:[e.jsxs("button",{onClick:()=>V(t.id),className:"w-full p-3 flex items-center justify-between cursor-pointer hover:bg-opacity-80 transition-all duration-200 rounded-t-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-3 h-3 bg-${b.accent} rounded-full mr-2 flex-shrink-0`}),e.jsxs("div",{className:"text-left",children:[e.jsxs("div",{className:`text-lg font-extrabold ${b.header}`,children:["AEK ",t.goalsa||0,":",t.goalsb||0," Real"]}),e.jsx("div",{className:`text-xs font-normal opacity-90 ${b.header}`,children:new Date(t.date).toLocaleDateString("de-DE")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:`text-xs bg-${b.accent} text-white px-2 py-1 rounded-full font-semibold`,children:[x.length," Transaktion",x.length!==1?"en":""]}),e.jsx("span",{className:`text-lg font-bold ${b.header} transition-transform duration-200 ${R?"rotate-90":""}`,children:"▶"})]})]}),!R&&e.jsx("div",{className:"p-3 pt-0",children:e.jsx("div",{className:"space-y-2",children:x.map(v=>e.jsx("div",{className:"bg-white bg-opacity-50 rounded-lg p-3 border border-white border-opacity-30",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"text-xl",children:A(v.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("h5",{className:"font-medium text-text-primary",children:v.info||"Transaktion"}),e.jsx("span",{className:`text-sm font-medium ${v.amount>0?"text-primary-green":"text-accent-red"}`,children:v.type})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-text-muted",children:[e.jsxs("span",{className:v.team==="AEK"?"text-blue-600":"text-red-600",children:[v.team==="AEK"?"🔵":"🔴"," ",v.team]}),v.date&&e.jsx("span",{children:new Date(v.date).toLocaleDateString("de-DE")})]})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:`text-lg font-bold ${v.amount>=0?"text-primary-green":"text-accent-red"}`,children:[v.amount<0?"-":"+",w(Math.abs(v.amount||0))]})})]})},v.id))})})]},t.id)})}):e.jsxs("div",{className:"modern-card text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"⚽"}),e.jsx("h4",{className:"text-lg font-medium text-text-primary mb-2",children:"Keine Match-Transaktionen"}),e.jsx("p",{className:"text-text-muted",children:"Es wurden noch keine match-bezogenen Transaktionen erfasst."})]})]}),O.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Sonstige Transaktionen"}),e.jsxs("div",{className:"border-2 border-slate-500 bg-slate-100 rounded-lg shadow-lg",children:[e.jsx("div",{className:"p-3 border-b border-slate-300",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-3 h-3 bg-slate-400 rounded-full mr-2 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-extrabold text-slate-700",children:"Sonstige Transaktionen"}),e.jsx("div",{className:"text-xs font-normal opacity-90 text-slate-600",children:"Nicht match-bezogene Buchungen"})]})]}),e.jsxs("div",{className:"text-xs bg-slate-400 text-slate-900 px-2 py-1 rounded-full font-semibold",children:[O.length," Buchung",O.length!==1?"en":""]})]})}),e.jsx("div",{className:"p-3",children:e.jsx("div",{className:"space-y-2",children:O.map(t=>e.jsx("div",{className:"bg-white rounded-lg p-3 border border-slate-200",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"text-xl",children:A(t.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("h5",{className:"font-medium text-text-primary",children:t.info||"Transaktion"}),e.jsx("span",{className:`text-sm font-medium ${t.amount>0?"text-primary-green":"text-accent-red"}`,children:t.type})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-text-muted",children:[e.jsxs("span",{className:t.team==="AEK"?"text-blue-600":"text-red-600",children:[t.team==="AEK"?"🔵":"🔴"," ",t.team]}),t.date&&e.jsx("span",{children:new Date(t.date).toLocaleDateString("de-DE")})]})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:`text-lg font-bold ${t.amount>=0?"text-primary-green":"text-accent-red"}`,children:[t.amount<0?"-":"+",w(Math.abs(t.amount||0))]})})]})},t.id))})})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-3",children:"Team-spezifische Ansicht"}),e.jsx("div",{className:"flex gap-2 mb-4",children:["AEK","Real"].map(t=>e.jsx("button",{onClick:()=>a(t),className:`px-4 py-2 rounded-lg font-medium transition-all ${n===t?t==="AEK"?"bg-blue-600 text-white":"bg-red-600 text-white":"bg-bg-secondary text-text-muted hover:bg-bg-tertiary border border-border-light"}`,children:t==="AEK"?"🔵 AEK Athen":"🔴 Real Madrid"},t))})]}),e.jsxs("div",{className:"modern-card mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h4",{className:"font-semibold text-text-primary",children:[n==="AEK"?"🔵 AEK Athen":"🔴 Real Madrid"," - Details"]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-bold text-text-primary",children:w(U.balance)}),e.jsx("div",{className:"text-sm text-text-muted",children:"Aktueller Kontostand"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-primary-green/10 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-primary-green",children:P.filter(t=>t.amount>0).length}),e.jsx("div",{className:"text-sm text-text-muted",children:"Einnahmen"})]}),e.jsxs("div",{className:"text-center p-3 bg-accent-red/10 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-accent-red",children:P.filter(t=>t.amount<0).length}),e.jsx("div",{className:"text-sm text-text-muted",children:"Ausgaben"})]})]})]}),e.jsx("div",{className:"mt-6 modern-card bg-blue-50 border-blue-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-blue-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-1",children:"Hinweis zu Marktwerten"}),e.jsx("p",{className:"text-blue-700 text-sm",children:"Spieler-Marktwerte werden in der Datenbank in Millionen Euro gespeichert (z.B. 12.5 = 12,5M €). Für die Gesamtkapital-Berechnung werden diese automatisch in Euro umgerechnet."})]})]})}),e.jsx("div",{className:"mt-6 modern-card bg-blue-50 border-blue-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-blue-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-1",children:"Transaktionen verwalten"}),e.jsx("p",{className:"text-blue-700 text-sm",children:"Um neue Transaktionen hinzuzufügen, nutzen Sie den Verwaltungsbereich."})]})]})}),o&&e.jsx(W,{onClose:()=>m(!1)})]})]})}export{me as default};
